
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.3">
    
    
      
        <title>plkit.module - plkit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.3b61ea93.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.8.1/css/all.css">
    
      <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.8.1/css/v4-shims.css">
    
      <link rel="stylesheet" href="../../css/mkapi-common.css">
    
      <link rel="stylesheet" href="../../style.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#plkitmodule" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="plkit" class="md-header-nav__button md-logo" aria-label="plkit">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            plkit
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              plkit.module
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="plkit" class="md-nav__button md-logo" aria-label="plkit">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    plkit
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../configurations/" class="md-nav__link">
      Configurations
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../datamodule/" class="md-nav__link">
      DataModule
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../module/" class="md-nav__link">
      Module
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../trainer/" class="md-nav__link">
      Trainer
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../runner/" class="md-nav__link">
      Runner
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../optuna/" class="md-nav__link">
      Optuna integration
    </a>
  </li>

    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" checked>
    
    <label class="md-nav__link" for="nav-8">
      API
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="API" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon"></span>
        API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-1" type="checkbox" id="nav-8-1" checked>
    
    <label class="md-nav__link" for="nav-8-1">
      plkit
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="plkit" data-md-level="2">
      <label class="md-nav__title" for="nav-8-1">
        <span class="md-nav__icon md-icon"></span>
        plkit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../plkit/" class="md-nav__link">
      plkit
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../plkit.trainer/" class="md-nav__link">
      plkit.trainer
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../plkit.runner/" class="md-nav__link">
      plkit.runner
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../plkit.exceptions/" class="md-nav__link">
      plkit.exceptions
    </a>
  </li>

        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        plkit.module
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      plkit.module
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#plkitmodule" class="md-nav__link">
    module
  </a>
  
    <nav class="md-nav" aria-label="module">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plkitmodulemodule" class="md-nav__link">
    Module
  </a>
  
    <nav class="md-nav" aria-label="Module">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleregister_buffer" class="md-nav__link">
    register_buffer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleregister_parameter" class="md-nav__link">
    register_parameter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleadd_module" class="md-nav__link">
    add_module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleapply" class="md-nav__link">
    apply
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleregister_backward_hook" class="md-nav__link">
    register_backward_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleregister_forward_pre_hook" class="md-nav__link">
    register_forward_pre_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleregister_forward_hook" class="md-nav__link">
    register_forward_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulestate_dict" class="md-nav__link">
    state_dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleload_state_dict" class="md-nav__link">
    load_state_dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleparameters" class="md-nav__link">
    parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulenamed_parameters" class="md-nav__link">
    named_parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulebuffers" class="md-nav__link">
    buffers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulenamed_buffers" class="md-nav__link">
    named_buffers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulechildren" class="md-nav__link">
    children
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulenamed_children" class="md-nav__link">
    named_children
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulemodules" class="md-nav__link">
    modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulenamed_modules" class="md-nav__link">
    named_modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduletrain" class="md-nav__link">
    train
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleeval" class="md-nav__link">
    eval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulerequires_grad_" class="md-nav__link">
    requires_grad_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulezero_grad" class="md-nav__link">
    zero_grad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleextra_repr" class="md-nav__link">
    extra_repr
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookssetup" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhooksteardown" class="md-nav__link">
    teardown
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_fit_start" class="md-nav__link">
    on_fit_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_fit_end" class="md-nav__link">
    on_fit_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_train_start" class="md-nav__link">
    on_train_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_train_end" class="md-nav__link">
    on_train_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_pretrain_routine_start" class="md-nav__link">
    on_pretrain_routine_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_pretrain_routine_end" class="md-nav__link">
    on_pretrain_routine_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_train_batch_start" class="md-nav__link">
    on_train_batch_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_train_batch_end" class="md-nav__link">
    on_train_batch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_validation_model_eval" class="md-nav__link">
    on_validation_model_eval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_validation_model_train" class="md-nav__link">
    on_validation_model_train
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_validation_batch_start" class="md-nav__link">
    on_validation_batch_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_validation_batch_end" class="md-nav__link">
    on_validation_batch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_test_batch_start" class="md-nav__link">
    on_test_batch_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_test_batch_end" class="md-nav__link">
    on_test_batch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_test_model_eval" class="md-nav__link">
    on_test_model_eval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_test_model_train" class="md-nav__link">
    on_test_model_train
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_epoch_start" class="md-nav__link">
    on_epoch_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_train_epoch_start" class="md-nav__link">
    on_train_epoch_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_train_epoch_end" class="md-nav__link">
    on_train_epoch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_validation_epoch_start" class="md-nav__link">
    on_validation_epoch_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_validation_epoch_end" class="md-nav__link">
    on_validation_epoch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_test_epoch_start" class="md-nav__link">
    on_test_epoch_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_test_epoch_end" class="md-nav__link">
    on_test_epoch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_before_zero_grad" class="md-nav__link">
    on_before_zero_grad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_after_backward" class="md-nav__link">
    on_after_backward
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksdatahooksprepare_data" class="md-nav__link">
    prepare_data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksdatahookstrain_dataloader" class="md-nav__link">
    train_dataloader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksdatahookstest_dataloader" class="md-nav__link">
    test_dataloader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksdatahooksval_dataloader" class="md-nav__link">
    val_dataloader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksdatahookstransfer_batch_to_device" class="md-nav__link">
    transfer_batch_to_device
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcoresavingmodelioload_from_checkpoint" class="md-nav__link">
    load_from_checkpoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcoresavingmodelioon_load_checkpoint" class="md-nav__link">
    on_load_checkpoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcoresavingmodelioon_save_checkpoint" class="md-nav__link">
    on_save_checkpoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcoresavingmodelioon_hpc_save" class="md-nav__link">
    on_hpc_save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcoresavingmodelioon_hpc_load" class="md-nav__link">
    on_hpc_load
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcoregradsgradinformationgrad_norm" class="md-nav__link">
    grad_norm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixinto" class="md-nav__link">
    to
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixincuda" class="md-nav__link">
    cuda
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixincpu" class="md-nav__link">
    cpu
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixintype" class="md-nav__link">
    type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixinfloat" class="md-nav__link">
    float
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixindouble" class="md-nav__link">
    double
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixinhalf" class="md-nav__link">
    half
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#abcabcmeta" class="md-nav__link">
    ABCMeta
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleprint" class="md-nav__link">
    print
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulelog" class="md-nav__link">
    log
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulelog_dict" class="md-nav__link">
    log_dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleall_gather" class="md-nav__link">
    all_gather
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleforward" class="md-nav__link">
    forward
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletraining_step" class="md-nav__link">
    training_step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletraining_step_end" class="md-nav__link">
    training_step_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletraining_epoch_end" class="md-nav__link">
    training_epoch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulevalidation_step" class="md-nav__link">
    validation_step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulevalidation_step_end" class="md-nav__link">
    validation_step_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulevalidation_epoch_end" class="md-nav__link">
    validation_epoch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletest_step" class="md-nav__link">
    test_step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletest_step_end" class="md-nav__link">
    test_step_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletest_epoch_end" class="md-nav__link">
    test_epoch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulemanual_backward" class="md-nav__link">
    manual_backward
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulebackward" class="md-nav__link">
    backward
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletoggle_optimizer" class="md-nav__link">
    toggle_optimizer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleoptimizer_step" class="md-nav__link">
    optimizer_step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletbptt_split_batch" class="md-nav__link">
    tbptt_split_batch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulefreeze" class="md-nav__link">
    freeze
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleunfreeze" class="md-nav__link">
    unfreeze
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleget_progress_bar_dict" class="md-nav__link">
    get_progress_bar_dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulesave_hyperparameters" class="md-nav__link">
    save_hyperparameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleto_onnx" class="md-nav__link">
    to_onnx
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleto_torchscript" class="md-nav__link">
    to_torchscript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plkitmodulemoduleon_epoch_end" class="md-nav__link">
    on_epoch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plkitmodulemoduleloss_function" class="md-nav__link">
    loss_function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plkitmodulemoduleconfigure_optimizers" class="md-nav__link">
    configure_optimizers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../plkit.data/" class="md-nav__link">
      plkit.data
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../plkit.optuna/" class="md-nav__link">
      plkit.optuna
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../plkit.utils/" class="md-nav__link">
      plkit.utils
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#plkitmodule" class="md-nav__link">
    module
  </a>
  
    <nav class="md-nav" aria-label="module">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plkitmodulemodule" class="md-nav__link">
    Module
  </a>
  
    <nav class="md-nav" aria-label="Module">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleregister_buffer" class="md-nav__link">
    register_buffer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleregister_parameter" class="md-nav__link">
    register_parameter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleadd_module" class="md-nav__link">
    add_module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleapply" class="md-nav__link">
    apply
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleregister_backward_hook" class="md-nav__link">
    register_backward_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleregister_forward_pre_hook" class="md-nav__link">
    register_forward_pre_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleregister_forward_hook" class="md-nav__link">
    register_forward_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulestate_dict" class="md-nav__link">
    state_dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleload_state_dict" class="md-nav__link">
    load_state_dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleparameters" class="md-nav__link">
    parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulenamed_parameters" class="md-nav__link">
    named_parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulebuffers" class="md-nav__link">
    buffers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulenamed_buffers" class="md-nav__link">
    named_buffers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulechildren" class="md-nav__link">
    children
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulenamed_children" class="md-nav__link">
    named_children
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulemodules" class="md-nav__link">
    modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulenamed_modules" class="md-nav__link">
    named_modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduletrain" class="md-nav__link">
    train
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleeval" class="md-nav__link">
    eval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulerequires_grad_" class="md-nav__link">
    requires_grad_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemodulezero_grad" class="md-nav__link">
    zero_grad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchnnmodulesmodulemoduleextra_repr" class="md-nav__link">
    extra_repr
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookssetup" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhooksteardown" class="md-nav__link">
    teardown
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_fit_start" class="md-nav__link">
    on_fit_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_fit_end" class="md-nav__link">
    on_fit_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_train_start" class="md-nav__link">
    on_train_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_train_end" class="md-nav__link">
    on_train_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_pretrain_routine_start" class="md-nav__link">
    on_pretrain_routine_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_pretrain_routine_end" class="md-nav__link">
    on_pretrain_routine_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_train_batch_start" class="md-nav__link">
    on_train_batch_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_train_batch_end" class="md-nav__link">
    on_train_batch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_validation_model_eval" class="md-nav__link">
    on_validation_model_eval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_validation_model_train" class="md-nav__link">
    on_validation_model_train
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_validation_batch_start" class="md-nav__link">
    on_validation_batch_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_validation_batch_end" class="md-nav__link">
    on_validation_batch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_test_batch_start" class="md-nav__link">
    on_test_batch_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_test_batch_end" class="md-nav__link">
    on_test_batch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_test_model_eval" class="md-nav__link">
    on_test_model_eval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_test_model_train" class="md-nav__link">
    on_test_model_train
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_epoch_start" class="md-nav__link">
    on_epoch_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_train_epoch_start" class="md-nav__link">
    on_train_epoch_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_train_epoch_end" class="md-nav__link">
    on_train_epoch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_validation_epoch_start" class="md-nav__link">
    on_validation_epoch_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_validation_epoch_end" class="md-nav__link">
    on_validation_epoch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_test_epoch_start" class="md-nav__link">
    on_test_epoch_start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_test_epoch_end" class="md-nav__link">
    on_test_epoch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_before_zero_grad" class="md-nav__link">
    on_before_zero_grad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksmodelhookson_after_backward" class="md-nav__link">
    on_after_backward
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksdatahooksprepare_data" class="md-nav__link">
    prepare_data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksdatahookstrain_dataloader" class="md-nav__link">
    train_dataloader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksdatahookstest_dataloader" class="md-nav__link">
    test_dataloader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksdatahooksval_dataloader" class="md-nav__link">
    val_dataloader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorehooksdatahookstransfer_batch_to_device" class="md-nav__link">
    transfer_batch_to_device
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcoresavingmodelioload_from_checkpoint" class="md-nav__link">
    load_from_checkpoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcoresavingmodelioon_load_checkpoint" class="md-nav__link">
    on_load_checkpoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcoresavingmodelioon_save_checkpoint" class="md-nav__link">
    on_save_checkpoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcoresavingmodelioon_hpc_save" class="md-nav__link">
    on_hpc_save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcoresavingmodelioon_hpc_load" class="md-nav__link">
    on_hpc_load
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcoregradsgradinformationgrad_norm" class="md-nav__link">
    grad_norm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixinto" class="md-nav__link">
    to
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixincuda" class="md-nav__link">
    cuda
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixincpu" class="md-nav__link">
    cpu
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixintype" class="md-nav__link">
    type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixinfloat" class="md-nav__link">
    float
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixindouble" class="md-nav__link">
    double
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixinhalf" class="md-nav__link">
    half
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#abcabcmeta" class="md-nav__link">
    ABCMeta
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleprint" class="md-nav__link">
    print
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulelog" class="md-nav__link">
    log
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulelog_dict" class="md-nav__link">
    log_dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleall_gather" class="md-nav__link">
    all_gather
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleforward" class="md-nav__link">
    forward
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletraining_step" class="md-nav__link">
    training_step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletraining_step_end" class="md-nav__link">
    training_step_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletraining_epoch_end" class="md-nav__link">
    training_epoch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulevalidation_step" class="md-nav__link">
    validation_step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulevalidation_step_end" class="md-nav__link">
    validation_step_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulevalidation_epoch_end" class="md-nav__link">
    validation_epoch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletest_step" class="md-nav__link">
    test_step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletest_step_end" class="md-nav__link">
    test_step_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletest_epoch_end" class="md-nav__link">
    test_epoch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulemanual_backward" class="md-nav__link">
    manual_backward
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulebackward" class="md-nav__link">
    backward
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletoggle_optimizer" class="md-nav__link">
    toggle_optimizer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleoptimizer_step" class="md-nav__link">
    optimizer_step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduletbptt_split_batch" class="md-nav__link">
    tbptt_split_batch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulefreeze" class="md-nav__link">
    freeze
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleunfreeze" class="md-nav__link">
    unfreeze
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleget_progress_bar_dict" class="md-nav__link">
    get_progress_bar_dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmodulesave_hyperparameters" class="md-nav__link">
    save_hyperparameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleto_onnx" class="md-nav__link">
    to_onnx
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_lightningcorelightninglightningmoduleto_torchscript" class="md-nav__link">
    to_torchscript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plkitmodulemoduleon_epoch_end" class="md-nav__link">
    on_epoch_end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plkitmodulemoduleloss_function" class="md-nav__link">
    loss_function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plkitmodulemoduleconfigure_optimizers" class="md-nav__link">
    configure_optimizers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>plkit.module</h1>
                
                <div class="mkapi-node" id="plkit.module">
<div class='mkapi-object-container'>
  <div class="mkapi-object module plain top">
    <div class="mkapi-object-kind module top">module</div>
    <h2 id="plkitmodule" class="mkapi-object-body module top"><span class="mkapi-object-prefix"><a href="../plkit/#plkit">plkit</a>.</span><span class="mkapi-object-name">module</span></h2>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/plkit.module/#plkit.module" title="Source for plkit.module">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>The core base module class based on pytorch_lightning.LightningModule</p></div>
    </div>
  <div class="mkapi-section classes">
      <div class="mkapi-section-name classes">
          <span class="mkapi-section-name-body classes">Classes</span> 
        </div>
      <div class="mkapi-section-body classes"><ul class="mkapi-items">
<li class="class"><code class="mkapi-item-name"><a href="#plkit.module.Module">Module</a></code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The Module class<a class="mkapi-src-link" href="../source/plkit.module/#plkit.module.Module" title="Source for plkit.module.Module">&lt;/&gt;</a></span></li>


</ul></div>
    </div>
  </div>

</div>

<div class="mkapi-node" id="plkit.module.Module">
<div class='mkapi-object-container'>
  <div class="mkapi-object class code top">
    <div class="mkapi-object-kind class top">class</div>
    <h3 id="plkitmodulemodule" class="mkapi-object-body class top"><code class="mkapi-object-prefix"><a href="#plkit.module">plkit.module</a>.</code><code class="mkapi-object-name">Module</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">config</code><code class="mkapi-object-parenthesis">)</code></h3>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/plkit.module/#plkit.module.Module" title="Source for plkit.module.Module">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section bases">
      <div class="mkapi-section-name bases">
          <span class="mkapi-section-name-body bases">Bases</span> 
        </div>
      <div class="mkapi-section-body bases">
<span class="mkapi-base">pytorch_lightning.core.lightning.LightningModule</span>

<span class="mkapi-base">abc.ABC</span>

<span class="mkapi-base">pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin</span>

<span class="mkapi-base">pytorch_lightning.core.grads.GradInformation</span>

<span class="mkapi-base">pytorch_lightning.core.saving.ModelIO</span>

<span class="mkapi-base">pytorch_lightning.core.hooks.ModelHooks</span>

<span class="mkapi-base">pytorch_lightning.core.hooks.DataHooks</span>

<span class="mkapi-base">pytorch_lightning.core.hooks.CheckpointHooks</span>

<span class="mkapi-base">torch.nn.modules.module.Module</span>
</div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>The Module class</p>
<p><code>on_epoch_end</code> is added to print a newline to keep the progress bar and the
stats on it for each epoch. If you don't want this, just overwrite it with:
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">on_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="k">pass</span>
</code></pre></div></p>
<p>If you have other stuff to do in <code>on_epoch_end</code>, make sure to you call:
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">on_epoch_end</span><span class="p">()</span>
</code></pre></div></p>
<p>You may or may not need to write <code>loss_function</code>, as it will be inferred
from config item <code>loss</code> and <code>num_classes</code>. Basically, <code>MSELoss</code> will be
used for regression and <code>CrossEntropyLoss</code> for classification.</p>
<p><code>measure</code> added for convinience to get some metrics between logits
and targets.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">config</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The configuration dictionary</span></li>


</ul></div>
    </div>
  <div class="mkapi-section attributes">
      <div class="mkapi-section-name attributes">
          <span class="mkapi-section-name-body attributes">Attributes</span> 
        </div>
      <div class="mkapi-section-body attributes"><ul class="mkapi-items">

<li><code class="mkapi-item-name">_loss_func</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The loss function</span></li>

<li class="readonly-property"><code class="mkapi-item-name">automatic_optimization</code>
<span class="mkapi-item-type">(bool)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">If False you are responsible for calling .backward, .step, zero_grad.<span id="pytorch_lightning.core.lightning.LightningModule.automatic_optimization"></span><a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.automatic_optimization" title="Source for pytorch_lightning.core.lightning.LightningModule.automatic_optimization">&lt;/&gt;</a></span></li>

<li><code class="mkapi-item-name">config</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The configs</span></li>

<li class="readonly-property"><code class="mkapi-item-name">current_epoch</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The current epoch<span id="pytorch_lightning.core.lightning.LightningModule.current_epoch"></span><a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.current_epoch" title="Source for pytorch_lightning.core.lightning.LightningModule.current_epoch">&lt;/&gt;</a></span></li>

<li class="readonly-property"><code class="mkapi-item-name">global_step</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Total training batches seen across all epochs<span id="pytorch_lightning.core.lightning.LightningModule.global_step"></span><a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.global_step" title="Source for pytorch_lightning.core.lightning.LightningModule.global_step">&lt;/&gt;</a></span></li>


<li><code class="mkapi-item-name">num_classes</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Number of classes to predict. 1 for regression</span></li>

<li class="readonly-property"><code class="mkapi-item-name">on_gpu</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">True if your model is currently running on GPUs.
Useful to set flags around the LightningModule for different CPU vs GPU behavior.<span id="pytorch_lightning.core.lightning.LightningModule.on_gpu"></span><a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.on_gpu" title="Source for pytorch_lightning.core.lightning.LightningModule.on_gpu">&lt;/&gt;</a></span></li>

<li><code class="mkapi-item-name">optim</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The optimizer name. currently only <code>adam</code> and <code>sgd</code>
are supported. With this, of course you can, but you don't need to
write <code>configure_optimizers</code>.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section classes">
      <div class="mkapi-section-name classes">
          <span class="mkapi-section-name-body classes">Classes</span> 
        </div>
      <div class="mkapi-section-body classes"><ul class="mkapi-items">
<li class="class"><code class="mkapi-item-name"><a href="#abc.ABCMeta">ABCMeta</a></code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Metaclass for defining Abstract Base Classes (ABCs).<a class="mkapi-src-link" href="../source/abc/#abc.ABCMeta" title="Source for abc.ABCMeta">&lt;/&gt;</a></span></li>


</ul></div>
    </div>
  <div class="mkapi-section methods">
      <div class="mkapi-section-name methods">
          <span class="mkapi-section-name-body methods">Methods</span> 
        </div>
      <div class="mkapi-section-body methods"><ul class="mkapi-items">
<li class="method"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.add_module">add_module</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">name</code>, <code class="mkapi-object-signature">module</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Adds a child module to the current module.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.add_module" title="Source for torch.nn.modules.module.Module.add_module">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.all_gather">all_gather</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">tensor</code>, <code class="mkapi-object-signature">group</code>, <code class="mkapi-object-signature">sync_grads</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Allows users to call <code>self.all_gather()</code> from the LightningModule, thus making
the <code>all_gather</code> operation accelerator agnostic.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.all_gather" title="Source for pytorch_lightning.core.lightning.LightningModule.all_gather">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.apply">apply</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">fn</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Applies <code>fn</code> recursively to every submodule (as returned by <code>.children()</code>)
as well as self. Typical use includes initializing the parameters of a model
(see also :ref:<code>nn-init-doc</code>).<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.apply" title="Source for torch.nn.modules.module.Module.apply">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.backward">backward</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">loss</code>, <code class="mkapi-object-signature">optimizer</code>, <code class="mkapi-object-signature">optimizer_idx</code>, <code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Override backward with your own implementation if you need to.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.backward" title="Source for pytorch_lightning.core.lightning.LightningModule.backward">&lt;/&gt;</a></span></li>

<li class="generator"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.buffers">buffers</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">recurse</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(torch.Tensor)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Returns an iterator over module buffers.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.buffers" title="Source for torch.nn.modules.module.Module.buffers">&lt;/&gt;</a></span></li>

<li class="generator"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.children">children</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Returns an iterator over immediate children modules.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.children" title="Source for torch.nn.modules.module.Module.children">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#plkit.module.Module.configure_optimizers">configure_optimizers</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Configure the optimizers<a class="mkapi-src-link" href="../source/plkit.module/#plkit.module.Module.configure_optimizers" title="Source for plkit.module.Module.configure_optimizers">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.cpu">cpu</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Moves all model parameters and buffers to the CPU.<a class="mkapi-src-link" href="../source/pytorch_lightning.utilities.device_dtype_mixin/#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.cpu" title="Source for pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.cpu">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.cuda">cuda</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">device</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Moves all model parameters and buffers to the GPU.
This also makes associated parameters and buffers different objects. So
it should be called before constructing optimizer if the module will
live on GPU while being optimized.<a class="mkapi-src-link" href="../source/pytorch_lightning.utilities.device_dtype_mixin/#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.cuda" title="Source for pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.cuda">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.double">double</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Casts all floating point parameters and buffers to <code>double</code> datatype.<a class="mkapi-src-link" href="../source/pytorch_lightning.utilities.device_dtype_mixin/#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.double" title="Source for pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.double">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.eval">eval</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Sets the module in evaluation mode.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.eval" title="Source for torch.nn.modules.module.Module.eval">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.extra_repr">extra_repr</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Set the extra representation of the module<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.extra_repr" title="Source for torch.nn.modules.module.Module.extra_repr">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.float">float</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Casts all floating point parameters and buffers to float datatype.<a class="mkapi-src-link" href="../source/pytorch_lightning.utilities.device_dtype_mixin/#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.float" title="Source for pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.float">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.forward">forward</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Same as :meth:<code>torch.nn.Module.forward()</code>, however in Lightning you want this to define
the operations you want to use for prediction (i.e.: on a server or as a feature extractor).<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.forward" title="Source for pytorch_lightning.core.lightning.LightningModule.forward">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.freeze">freeze</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Freeze all params for inference.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.freeze" title="Source for pytorch_lightning.core.lightning.LightningModule.freeze">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.get_progress_bar_dict">get_progress_bar_dict</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(dict(str: int or str))</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Implement this to override the default items displayed in the progress bar.
By default it includes the average loss value, split index of BPTT (if used)
and the version of the experiment when using a logger.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.get_progress_bar_dict" title="Source for pytorch_lightning.core.lightning.LightningModule.get_progress_bar_dict">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.grads.GradInformation.grad_norm">grad_norm</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">norm_type</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(dict(str: float))</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Compute each parameter's gradient's norm and their overall norm.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.grads/#pytorch_lightning.core.grads.GradInformation.grad_norm" title="Source for pytorch_lightning.core.grads.GradInformation.grad_norm">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.half">half</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Casts all floating point parameters and buffers to <code>half</code> datatype.<a class="mkapi-src-link" href="../source/pytorch_lightning.utilities.device_dtype_mixin/#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.half" title="Source for pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.half">&lt;/&gt;</a></span></li>

<li class="classmethod"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.saving.ModelIO.load_from_checkpoint">load_from_checkpoint</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">checkpoint_path</code>, <code class="mkapi-object-signature">map_location</code>, <code class="mkapi-object-signature">hparams_file</code>, <code class="mkapi-object-signature">strict</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Primary way of loading a model from a checkpoint. When Lightning saves a checkpoint
it stores the arguments passed to <code>__init__</code>  in the checkpoint under <code>hyper_parameters</code><a class="mkapi-src-link" href="../source/pytorch_lightning.core.saving/#pytorch_lightning.core.saving.ModelIO.load_from_checkpoint" title="Source for pytorch_lightning.core.saving.ModelIO.load_from_checkpoint">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.load_state_dict">load_state_dict</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">state_dict</code>, <code class="mkapi-object-signature">strict</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(``NamedTuple`` with ``missing_keys`` and ``unexpected_keys`` fields)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Copies parameters and buffers from :attr:<code>state_dict</code> into
this module and its descendants. If :attr:<code>strict</code> is <code>True</code>, then
the keys of :attr:<code>state_dict</code> must exactly match the keys returned
by this module's :meth:<code>~torch.nn.Module.state_dict</code> function.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.load_state_dict" title="Source for torch.nn.modules.module.Module.load_state_dict">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.log">log</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">name</code>, <code class="mkapi-object-signature">value</code>, <code class="mkapi-object-signature">prog_bar</code>, <code class="mkapi-object-signature">logger</code>, <code class="mkapi-object-signature">on_step</code>, <code class="mkapi-object-signature">on_epoch</code>, <code class="mkapi-object-signature">reduce_fx</code>, <code class="mkapi-object-signature">tbptt_reduce_fx</code>, <code class="mkapi-object-signature">tbptt_pad_token</code>, <code class="mkapi-object-signature">enable_graph</code>, <code class="mkapi-object-signature">sync_dist</code>, <code class="mkapi-object-signature">sync_dist_op</code>, <code class="mkapi-object-signature">sync_dist_group</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Log a key, value<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.log" title="Source for pytorch_lightning.core.lightning.LightningModule.log">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.log_dict">log_dict</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">dictionary</code>, <code class="mkapi-object-signature">prog_bar</code>, <code class="mkapi-object-signature">logger</code>, <code class="mkapi-object-signature">on_step</code>, <code class="mkapi-object-signature">on_epoch</code>, <code class="mkapi-object-signature">reduce_fx</code>, <code class="mkapi-object-signature">tbptt_reduce_fx</code>, <code class="mkapi-object-signature">tbptt_pad_token</code>, <code class="mkapi-object-signature">enable_graph</code>, <code class="mkapi-object-signature">sync_dist</code>, <code class="mkapi-object-signature">sync_dist_op</code>, <code class="mkapi-object-signature">sync_dist_group</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Log a dictonary of values at once<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.log_dict" title="Source for pytorch_lightning.core.lightning.LightningModule.log_dict">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#plkit.module.Module.loss_function">loss_function</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">logits</code>, <code class="mkapi-object-signature">labels</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Calculate the loss<a class="mkapi-src-link" href="../source/plkit.module/#plkit.module.Module.loss_function" title="Source for plkit.module.Module.loss_function">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.manual_backward">manual_backward</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">loss</code>, <code class="mkapi-object-signature">optimizer</code>, <code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Call this directly from your training_step when doing optimizations manually.
By using this we can ensure that all the proper scaling when using 16-bit etc has been done for you<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.manual_backward" title="Source for pytorch_lightning.core.lightning.LightningModule.manual_backward">&lt;/&gt;</a></span></li>

<li class="generator"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.modules">modules</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Returns an iterator over all modules in the network.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.modules" title="Source for torch.nn.modules.module.Module.modules">&lt;/&gt;</a></span></li>

<li class="generator"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.named_buffers">named_buffers</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">prefix</code>, <code class="mkapi-object-signature">recurse</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(string, torch.Tensor)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Returns an iterator over module buffers, yielding both the
name of the buffer as well as the buffer itself.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.named_buffers" title="Source for torch.nn.modules.module.Module.named_buffers">&lt;/&gt;</a></span></li>

<li class="generator"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.named_children">named_children</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(string, Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Returns an iterator over immediate children modules, yielding both
the name of the module as well as the module itself.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.named_children" title="Source for torch.nn.modules.module.Module.named_children">&lt;/&gt;</a></span></li>

<li class="generator"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.named_modules">named_modules</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">memo</code>, <code class="mkapi-object-signature">prefix</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(string, Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Returns an iterator over all modules in the network, yielding
both the name of the module as well as the module itself.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.named_modules" title="Source for torch.nn.modules.module.Module.named_modules">&lt;/&gt;</a></span></li>

<li class="generator"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.named_parameters">named_parameters</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">prefix</code>, <code class="mkapi-object-signature">recurse</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(string, Parameter)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Returns an iterator over module parameters, yielding both the
name of the parameter as well as the parameter itself.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.named_parameters" title="Source for torch.nn.modules.module.Module.named_parameters">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_after_backward">on_after_backward</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called in the training loop after loss.backward() and before optimizers do anything.
This is the ideal place to inspect or log gradient information.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_after_backward" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_after_backward">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_before_zero_grad">on_before_zero_grad</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">optimizer</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called after optimizer.step() and before optimizer.zero_grad().<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_before_zero_grad" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_before_zero_grad">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#plkit.module.Module.on_epoch_end">on_epoch_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Keep the epoch progress bar
This is not documented but working.<a class="mkapi-src-link" href="../source/plkit.module/#plkit.module.Module.on_epoch_end" title="Source for plkit.module.Module.on_epoch_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_epoch_start">on_epoch_start</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called in the training loop at the very beginning of the epoch.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_epoch_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_epoch_start">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_fit_end">on_fit_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called at the very end of fit.
If on DDP it is called on every process<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_fit_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_fit_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_fit_start">on_fit_start</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called at the very beginning of fit.
If on DDP it is called on every process<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_fit_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_fit_start">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.saving.ModelIO.on_hpc_load">on_hpc_load</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">checkpoint</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Hook to do whatever you need right before Slurm manager loads the model.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.saving/#pytorch_lightning.core.saving.ModelIO.on_hpc_load" title="Source for pytorch_lightning.core.saving.ModelIO.on_hpc_load">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.saving.ModelIO.on_hpc_save">on_hpc_save</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">checkpoint</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Hook to do whatever you need right before Slurm manager saves the model.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.saving/#pytorch_lightning.core.saving.ModelIO.on_hpc_save" title="Source for pytorch_lightning.core.saving.ModelIO.on_hpc_save">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.saving.ModelIO.on_load_checkpoint">on_load_checkpoint</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">checkpoint</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Do something with the checkpoint.
Gives model a chance to load something before <code>state_dict</code> is restored.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.saving/#pytorch_lightning.core.saving.ModelIO.on_load_checkpoint" title="Source for pytorch_lightning.core.saving.ModelIO.on_load_checkpoint">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_pretrain_routine_end">on_pretrain_routine_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called at the end of the pretrain routine (between fit and train start).<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_pretrain_routine_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_pretrain_routine_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_pretrain_routine_start">on_pretrain_routine_start</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called at the beginning of the pretrain routine (between fit and train start).<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_pretrain_routine_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_pretrain_routine_start">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.saving.ModelIO.on_save_checkpoint">on_save_checkpoint</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">checkpoint</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Give the model a chance to add something to the checkpoint.
<code>state_dict</code> is already there.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.saving/#pytorch_lightning.core.saving.ModelIO.on_save_checkpoint" title="Source for pytorch_lightning.core.saving.ModelIO.on_save_checkpoint">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_test_batch_end">on_test_batch_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">outputs</code>, <code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">batch_idx</code>, <code class="mkapi-object-signature">dataloader_idx</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called in the test loop after the batch.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_test_batch_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_test_batch_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_test_batch_start">on_test_batch_start</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">batch_idx</code>, <code class="mkapi-object-signature">dataloader_idx</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called in the test loop before anything happens for that batch.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_test_batch_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_test_batch_start">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_test_epoch_end">on_test_epoch_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called in the test loop at the very end of the epoch.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_test_epoch_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_test_epoch_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_test_epoch_start">on_test_epoch_start</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called in the test loop at the very beginning of the epoch.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_test_epoch_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_test_epoch_start">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_test_model_eval">on_test_model_eval</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Sets the model to eval during the test loop<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_test_model_eval" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_test_model_eval">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_test_model_train">on_test_model_train</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Sets the model to train during the test loop<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_test_model_train" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_test_model_train">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_train_batch_end">on_train_batch_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">outputs</code>, <code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">batch_idx</code>, <code class="mkapi-object-signature">dataloader_idx</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called in the training loop after the batch.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_train_batch_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_train_batch_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_train_batch_start">on_train_batch_start</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">batch_idx</code>, <code class="mkapi-object-signature">dataloader_idx</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called in the training loop before anything happens for that batch.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_train_batch_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_train_batch_start">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_train_end">on_train_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called at the end of training before logger experiment is closed.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_train_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_train_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_train_epoch_end">on_train_epoch_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">outputs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called in the training loop at the very end of the epoch.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_train_epoch_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_train_epoch_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_train_epoch_start">on_train_epoch_start</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called in the training loop at the very beginning of the epoch.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_train_epoch_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_train_epoch_start">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_train_start">on_train_start</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called at the beginning of training before sanity check.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_train_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_train_start">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_validation_batch_end">on_validation_batch_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">outputs</code>, <code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">batch_idx</code>, <code class="mkapi-object-signature">dataloader_idx</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called in the validation loop after the batch.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_validation_batch_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_validation_batch_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_validation_batch_start">on_validation_batch_start</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">batch_idx</code>, <code class="mkapi-object-signature">dataloader_idx</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called in the validation loop before anything happens for that batch.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_validation_batch_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_validation_batch_start">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_validation_epoch_end">on_validation_epoch_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called in the validation loop at the very end of the epoch.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_validation_epoch_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_validation_epoch_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_validation_epoch_start">on_validation_epoch_start</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called in the validation loop at the very beginning of the epoch.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_validation_epoch_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_validation_epoch_start">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_validation_model_eval">on_validation_model_eval</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Sets the model to eval during the val loop<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_validation_model_eval" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_validation_model_eval">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.on_validation_model_train">on_validation_model_train</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Sets the model to train during the val loop<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_validation_model_train" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_validation_model_train">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.optimizer_step">optimizer_step</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">epoch</code>, <code class="mkapi-object-signature">batch_idx</code>, <code class="mkapi-object-signature">optimizer</code>, <code class="mkapi-object-signature">optimizer_idx</code>, <code class="mkapi-object-signature">optimizer_closure</code>, <code class="mkapi-object-signature">on_tpu</code>, <code class="mkapi-object-signature">using_native_amp</code>, <code class="mkapi-object-signature">using_lbfgs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Override this method to adjust the default way the
:class:<code>~pytorch_lightning.trainer.trainer.Trainer</code> calls each optimizer.
By default, Lightning calls <code>step()</code> and <code>zero_grad()</code> as shown in the example
once per optimizer.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.optimizer_step" title="Source for pytorch_lightning.core.lightning.LightningModule.optimizer_step">&lt;/&gt;</a></span></li>

<li class="generator"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.parameters">parameters</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">recurse</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Parameter)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Returns an iterator over module parameters.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.parameters" title="Source for torch.nn.modules.module.Module.parameters">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.DataHooks.prepare_data">prepare_data</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Use this to download and prepare data.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.DataHooks.prepare_data" title="Source for pytorch_lightning.core.hooks.DataHooks.prepare_data">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.print">print</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Prints only from process 0. Use this in any distributed mode to log only once.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.print" title="Source for pytorch_lightning.core.lightning.LightningModule.print">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.register_backward_hook">register_backward_hook</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">hook</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Registers a backward hook on the module.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.register_backward_hook" title="Source for torch.nn.modules.module.Module.register_backward_hook">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.register_buffer">register_buffer</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">name</code>, <code class="mkapi-object-signature">tensor</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Adds a persistent buffer to the module.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.register_buffer" title="Source for torch.nn.modules.module.Module.register_buffer">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.register_forward_hook">register_forward_hook</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">hook</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Registers a forward hook on the module.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.register_forward_hook" title="Source for torch.nn.modules.module.Module.register_forward_hook">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.register_forward_pre_hook">register_forward_pre_hook</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">hook</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Registers a forward pre-hook on the module.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.register_forward_pre_hook" title="Source for torch.nn.modules.module.Module.register_forward_pre_hook">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.register_parameter">register_parameter</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">name</code>, <code class="mkapi-object-signature">param</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Adds a parameter to the module.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.register_parameter" title="Source for torch.nn.modules.module.Module.register_parameter">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.requires_grad_">requires_grad_</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">requires_grad</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Change if autograd should record operations on parameters in this
module.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.requires_grad_" title="Source for torch.nn.modules.module.Module.requires_grad_">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.save_hyperparameters">save_hyperparameters</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">frame</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Save all model arguments.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.save_hyperparameters" title="Source for pytorch_lightning.core.lightning.LightningModule.save_hyperparameters">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.setup">setup</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">stage</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called at the beginning of fit and test.
This is a good hook when you need to build models dynamically or adjust something about them.
This hook is called on every process when using DDP.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.setup" title="Source for pytorch_lightning.core.hooks.ModelHooks.setup">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.state_dict">state_dict</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">destination</code>, <code class="mkapi-object-signature">prefix</code>, <code class="mkapi-object-signature">keep_vars</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(dict)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Returns a dictionary containing a whole state of the module.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.state_dict" title="Source for torch.nn.modules.module.Module.state_dict">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.tbptt_split_batch">tbptt_split_batch</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">split_size</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(list)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">When using truncated backpropagation through time, each batch must be split along the
time dimension. Lightning handles this by default, but for custom behavior override
this function.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.tbptt_split_batch" title="Source for pytorch_lightning.core.lightning.LightningModule.tbptt_split_batch">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.ModelHooks.teardown">teardown</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">stage</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called at the end of fit and test.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.teardown" title="Source for pytorch_lightning.core.hooks.ModelHooks.teardown">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.DataHooks.test_dataloader">test_dataloader</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Union(dataloader, list of dataloader))</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Implement one or multiple PyTorch DataLoaders for testing.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.DataHooks.test_dataloader" title="Source for pytorch_lightning.core.hooks.DataHooks.test_dataloader">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.test_epoch_end">test_epoch_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">outputs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called at the end of a test epoch with the output of all test steps.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.test_epoch_end" title="Source for pytorch_lightning.core.lightning.LightningModule.test_epoch_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.test_step">test_step</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Operates on a single batch of data from the test set.
In this step you'd normally generate examples or calculate anything of interest
such as accuracy.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.test_step" title="Source for pytorch_lightning.core.lightning.LightningModule.test_step">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.test_step_end">test_step_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Use this when testing with dp or ddp2 because :meth:<code>test_step</code> will operate
on only part of the batch. However, this is still optional
and only needed for things like softmax or NCE loss.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.test_step_end" title="Source for pytorch_lightning.core.lightning.LightningModule.test_step_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.to">to</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Moves and/or casts the parameters and buffers.<a class="mkapi-src-link" href="../source/pytorch_lightning.utilities.device_dtype_mixin/#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.to" title="Source for pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.to">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.to_onnx">to_onnx</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">file_path</code>, <code class="mkapi-object-signature">input_sample</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Saves the model in ONNX format<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.to_onnx" title="Source for pytorch_lightning.core.lightning.LightningModule.to_onnx">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.to_torchscript">to_torchscript</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">file_path</code>, <code class="mkapi-object-signature">method</code>, <code class="mkapi-object-signature">example_inputs</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Union(scriptmodule, dict(str: scriptmodule)))</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">By default compiles the whole model to a :class:<code>~torch.jit.ScriptModule</code>.
If you want to use tracing, please provided the argument <code>method='trace'</code> and make sure that either the
example_inputs argument is provided, or the model has self.example_input_array set.
If you would like to customize the modules that are scripted you should override this method.
In case you want to return multiple modules, we recommend using a dictionary.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.to_torchscript" title="Source for pytorch_lightning.core.lightning.LightningModule.to_torchscript">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.toggle_optimizer">toggle_optimizer</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">optimizer</code>, <code class="mkapi-object-signature">optimizer_idx</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Makes sure only the gradients of the current optimizer's parameters are calculated
in the training step to prevent dangling gradients in multiple-optimizer setup.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.toggle_optimizer" title="Source for pytorch_lightning.core.lightning.LightningModule.toggle_optimizer">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.train">train</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">mode</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Sets the module in training mode.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.train" title="Source for torch.nn.modules.module.Module.train">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.DataHooks.train_dataloader">train_dataloader</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(DataLoader)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Implement a PyTorch DataLoader for training.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.DataHooks.train_dataloader" title="Source for pytorch_lightning.core.hooks.DataHooks.train_dataloader">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.training_epoch_end">training_epoch_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">outputs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called at the end of the training epoch with the outputs of all training steps.
Use this in case you need to do something with all the outputs for every training_step.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.training_epoch_end" title="Source for pytorch_lightning.core.lightning.LightningModule.training_epoch_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.training_step">training_step</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Here you compute and return the training loss and some additional metrics for e.g.
the progress bar or logger.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.training_step" title="Source for pytorch_lightning.core.lightning.LightningModule.training_step">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.training_step_end">training_step_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Use this when training with dp or ddp2 because :meth:<code>training_step</code>
will operate on only part of the batch. However, this is still optional
and only needed for things like softmax or NCE loss.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.training_step_end" title="Source for pytorch_lightning.core.lightning.LightningModule.training_step_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.DataHooks.transfer_batch_to_device">transfer_batch_to_device</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">device</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Override this hook if your :class:<code>~torch.utils.data.DataLoader</code> returns tensors
wrapped in a custom data structure.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.DataHooks.transfer_batch_to_device" title="Source for pytorch_lightning.core.hooks.DataHooks.transfer_batch_to_device">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.type">type</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">dst_type</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Casts all parameters and buffers to :attr:<code>dst_type</code>.<a class="mkapi-src-link" href="../source/pytorch_lightning.utilities.device_dtype_mixin/#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.type" title="Source for pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.type">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.unfreeze">unfreeze</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Unfreeze all parameters for training.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.unfreeze" title="Source for pytorch_lightning.core.lightning.LightningModule.unfreeze">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.hooks.DataHooks.val_dataloader">val_dataloader</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>
<span class="mkapi-item-type">(Union(dataloader, list of dataloader))</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Implement one or multiple PyTorch DataLoaders for validation.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.DataHooks.val_dataloader" title="Source for pytorch_lightning.core.hooks.DataHooks.val_dataloader">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.validation_epoch_end">validation_epoch_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">outputs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Called at the end of the validation epoch with the outputs of all validation steps.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.validation_epoch_end" title="Source for pytorch_lightning.core.lightning.LightningModule.validation_epoch_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.validation_step">validation_step</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Operates on a single batch of data from the validation set.
In this step you'd might generate examples or calculate anything of interest like accuracy.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.validation_step" title="Source for pytorch_lightning.core.lightning.LightningModule.validation_step">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#pytorch_lightning.core.lightning.LightningModule.validation_step_end">validation_step_end</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Use this when validating with dp or ddp2 because :meth:<code>validation_step</code>
will operate on only part of the batch. However, this is still optional
and only needed for things like softmax or NCE loss.<a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.validation_step_end" title="Source for pytorch_lightning.core.lightning.LightningModule.validation_step_end">&lt;/&gt;</a></span></li>

<li class="method"><code class="mkapi-item-name"><a href="#torch.nn.modules.module.Module.zero_grad">zero_grad</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Sets gradients of all model parameters to zero.<a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.zero_grad" title="Source for torch.nn.modules.module.Module.zero_grad">&lt;/&gt;</a></span></li>


</ul></div>
    </div>
  </div>

  <div class="mkapi-members">
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.register_buffer">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="torchnnmodulesmodulemoduleregister_buffer" class="mkapi-object-body method"><code class="mkapi-object-name">register_buffer</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">name</code>, <code class="mkapi-object-signature">tensor</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.register_buffer" title="Source for torch.nn.modules.module.Module.register_buffer">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Adds a persistent buffer to the module.</p>
<p>This is typically used to register a buffer that should not to be
considered a model parameter. For example, BatchNorm's <code>running_mean</code>
is not a parameter, but is part of the persistent state.</p>
<p>Buffers can be accessed as attributes using given names.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">name</code>
<span class="mkapi-item-type">(string)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">name of the buffer. The buffer can be accessed
from this module using the given name</span></li>

<li><code class="mkapi-item-name">tensor</code>
<span class="mkapi-item-type">(Tensor)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">buffer to be registered.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Example::</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_buffer</span><span class="p">(</span><span class="s1">&#39;running_mean&#39;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_features</span><span class="p">))</span>
</code></pre></div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.register_parameter">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="torchnnmodulesmodulemoduleregister_parameter" class="mkapi-object-body method"><code class="mkapi-object-name">register_parameter</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">name</code>, <code class="mkapi-object-signature">param</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.register_parameter" title="Source for torch.nn.modules.module.Module.register_parameter">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Adds a parameter to the module.</p>
<p>The parameter can be accessed as an attribute using given name.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">name</code>
<span class="mkapi-item-type">(string)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">name of the parameter. The parameter can be accessed
from this module using the given name</span></li>

<li><code class="mkapi-item-name">param</code>
<span class="mkapi-item-type">(Parameter)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">parameter to be added to the module.</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.add_module">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="torchnnmodulesmodulemoduleadd_module" class="mkapi-object-body method"><code class="mkapi-object-name">add_module</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">name</code>, <code class="mkapi-object-signature">module</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.add_module" title="Source for torch.nn.modules.module.Module.add_module">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Adds a child module to the current module.</p>
<p>The module can be accessed as an attribute using the given name.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">name</code>
<span class="mkapi-item-type">(string)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">name of the child module. The child module can be
accessed from this module using the given name</span></li>

<li><code class="mkapi-item-name">module</code>
<span class="mkapi-item-type">(Module)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">child module to be added to the module.</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.apply">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="torchnnmodulesmodulemoduleapply" class="mkapi-object-body method"><code class="mkapi-object-name">apply</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">fn</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.apply" title="Source for torch.nn.modules.module.Module.apply">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Applies <code>fn</code> recursively to every submodule (as returned by <code>.children()</code>)
as well as self. Typical use includes initializing the parameters of a model
(see also :ref:<code>nn-init-doc</code>).</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">

<li><code class="mkapi-item-name">fn (</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">class:<code>Module</code> -&gt; None): function to be applied to each submodule</span></li>


</ul></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> <span class="mkapi-item-type">(Module)</span>
        </div>
      <div class="mkapi-section-body returns"><p>self</p></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Example::</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">init_weights</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">:</span>
<span class="o">&gt;&gt;&gt;</span>         <span class="n">m</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>         <span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">init_weights</span><span class="p">)</span>
<span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Parameter</span> <span class="n">containing</span><span class="p">:</span>
<span class="n">tensor</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">]])</span>
<span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Parameter</span> <span class="n">containing</span><span class="p">:</span>
<span class="n">tensor</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">]])</span>
<span class="n">Sequential</span><span class="p">(</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">Sequential</span><span class="p">(</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.register_backward_hook">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="torchnnmodulesmodulemoduleregister_backward_hook" class="mkapi-object-body method"><code class="mkapi-object-name">register_backward_hook</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">hook</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.register_backward_hook" title="Source for torch.nn.modules.module.Module.register_backward_hook">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Registers a backward hook on the module.</p>
<p>The hook will be called every time the gradients with respect to module
inputs are computed. The hook should have the following signature::</p>
<pre><code>hook(module, grad_input, grad_output) -&gt; Tensor or None
</code></pre>
<p>The :attr:<code>grad_input</code> and :attr:<code>grad_output</code> may be tuples if the
module has multiple inputs or outputs. The hook should not modify its
arguments, but it can optionally return a new gradient with respect to
input that will be used in place of :attr:<code>grad_input</code> in subsequent
computations.</p></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> 
        </div>
      <div class="mkapi-section-body returns"><p>class:<code>torch.utils.hooks.RemovableHandle</code>:
    a handle that can be used to remove the added hook by calling
    <code>handle.remove()</code></p></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>.. warning ::</p>
<pre><code>The current implementation will not have the presented behavior
for complex :class:`Module` that perform many operations.
In some failure cases, :attr:`grad_input` and :attr:`grad_output` will only
contain the gradients for a subset of the inputs and outputs.
For such :class:`Module`, you should use :func:`torch.Tensor.register_hook`
directly on a specific input or output to get the required gradients.
</code></pre></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.register_forward_pre_hook">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="torchnnmodulesmodulemoduleregister_forward_pre_hook" class="mkapi-object-body method"><code class="mkapi-object-name">register_forward_pre_hook</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">hook</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.register_forward_pre_hook" title="Source for torch.nn.modules.module.Module.register_forward_pre_hook">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Registers a forward pre-hook on the module.</p>
<p>The hook will be called every time before :func:<code>forward</code> is invoked.
It should have the following signature::</p>
<pre><code>hook(module, input) -&gt; None or modified input
</code></pre>
<p>The hook can modify the input. User can either return a tuple or a
single modified value in the hook. We will wrap the value into a tuple
if a single value is returned(unless that value is already a tuple).</p></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> 
        </div>
      <div class="mkapi-section-body returns"><p>class:<code>torch.utils.hooks.RemovableHandle</code>:
    a handle that can be used to remove the added hook by calling
    <code>handle.remove()</code></p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.register_forward_hook">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="torchnnmodulesmodulemoduleregister_forward_hook" class="mkapi-object-body method"><code class="mkapi-object-name">register_forward_hook</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">hook</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.register_forward_hook" title="Source for torch.nn.modules.module.Module.register_forward_hook">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Registers a forward hook on the module.</p>
<p>The hook will be called every time after :func:<code>forward</code> has computed an output.
It should have the following signature::</p>
<pre><code>hook(module, input, output) -&gt; None or modified output
</code></pre>
<p>The hook can modify the output. It can modify the input inplace but
it will not have effect on forward since this is called after
:func:<code>forward</code> is called.</p></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> 
        </div>
      <div class="mkapi-section-body returns"><p>class:<code>torch.utils.hooks.RemovableHandle</code>:
    a handle that can be used to remove the added hook by calling
    <code>handle.remove()</code></p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.state_dict">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="torchnnmodulesmodulemodulestate_dict" class="mkapi-object-body method"><code class="mkapi-object-name">state_dict</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">destination=None</code>, <code class="mkapi-object-signature">prefix=&#39;&#39;</code>, <code class="mkapi-object-signature">keep_vars=False</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.state_dict" title="Source for torch.nn.modules.module.Module.state_dict">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Returns a dictionary containing a whole state of the module.</p>
<p>Both parameters and persistent buffers (e.g. running averages) are
included. Keys are corresponding parameter and buffer names.</p></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> <span class="mkapi-item-type">(dict)</span>
        </div>
      <div class="mkapi-section-body returns"><p>e</p></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Example::</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">module</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="p">[</span><span class="s1">&#39;bias&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">]</span>
</code></pre></div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.load_state_dict">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="torchnnmodulesmodulemoduleload_state_dict" class="mkapi-object-body method"><code class="mkapi-object-name">load_state_dict</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">state_dict</code>, <code class="mkapi-object-signature">strict=True</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.load_state_dict" title="Source for torch.nn.modules.module.Module.load_state_dict">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Copies parameters and buffers from :attr:<code>state_dict</code> into
this module and its descendants. If :attr:<code>strict</code> is <code>True</code>, then
the keys of :attr:<code>state_dict</code> must exactly match the keys returned
by this module's :meth:<code>~torch.nn.Module.state_dict</code> function.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">state_dict</code>
<span class="mkapi-item-type">(dict)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">a dict containing parameters and
persistent buffers.</span></li>

<li><code class="mkapi-item-name">strict</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">whether to strictly enforce that the keys
in :attr:<code>state_dict</code> match the keys returned by this module's
:meth:<code>~torch.nn.Module.state_dict</code> function. Default: <code>True</code></span></li>


</ul></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> <span class="mkapi-item-type">(``NamedTuple`` with ``missing_keys`` and ``unexpected_keys`` fields)</span>
        </div>
      <div class="mkapi-section-body returns"><p>s
s</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.parameters">
<div class='mkapi-object-container'>
  <div class="mkapi-object generator code">
    <div class="mkapi-object-kind generator">generator</div>
    <h4 id="torchnnmodulesmodulemoduleparameters" class="mkapi-object-body generator"><code class="mkapi-object-name">parameters</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">recurse=True</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.parameters" title="Source for torch.nn.modules.module.Module.parameters">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Returns an iterator over module parameters.</p>
<p>This is typically passed to an optimizer.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">recurse</code>
<span class="mkapi-item-type">(bool)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True, then yields parameters of this module
and all submodules. Otherwise, yields only parameters that
are direct members of this module.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section yields">
      <div class="mkapi-section-name yields">
          <span class="mkapi-section-name-body yields">Yields</span> <span class="mkapi-item-type">(Parameter)</span>
        </div>
      <div class="mkapi-section-body yields"><p>module parameter</p></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Example::</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="n">param</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="s1">&#39;&gt; (20L,)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="s1">&#39;&gt; (20L, 1L, 5L, 5L)</span>
</code></pre></div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.named_parameters">
<div class='mkapi-object-container'>
  <div class="mkapi-object generator code">
    <div class="mkapi-object-kind generator">generator</div>
    <h4 id="torchnnmodulesmodulemodulenamed_parameters" class="mkapi-object-body generator"><code class="mkapi-object-name">named_parameters</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">prefix=&#39;&#39;</code>, <code class="mkapi-object-signature">recurse=True</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.named_parameters" title="Source for torch.nn.modules.module.Module.named_parameters">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Returns an iterator over module parameters, yielding both the
name of the parameter as well as the parameter itself.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">prefix</code>
<span class="mkapi-item-type">(str)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">prefix to prepend to all parameter names.</span></li>

<li><code class="mkapi-item-name">recurse</code>
<span class="mkapi-item-type">(bool)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True, then yields parameters of this module
and all submodules. Otherwise, yields only parameters that
are direct members of this module.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section yields">
      <div class="mkapi-section-name yields">
          <span class="mkapi-section-name-body yields">Yields</span> <span class="mkapi-item-type">(string, Parameter)</span>
        </div>
      <div class="mkapi-section-body yields"><p>Tuple containing the name and parameter</p></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Example::</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
<span class="o">&gt;&gt;&gt;</span>    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;bias&#39;</span><span class="p">]:</span>
<span class="o">&gt;&gt;&gt;</span>        <span class="nb">print</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
</code></pre></div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.buffers">
<div class='mkapi-object-container'>
  <div class="mkapi-object generator code">
    <div class="mkapi-object-kind generator">generator</div>
    <h4 id="torchnnmodulesmodulemodulebuffers" class="mkapi-object-body generator"><code class="mkapi-object-name">buffers</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">recurse=True</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.buffers" title="Source for torch.nn.modules.module.Module.buffers">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Returns an iterator over module buffers.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">recurse</code>
<span class="mkapi-item-type">(bool)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True, then yields buffers of this module
and all submodules. Otherwise, yields only buffers that
are direct members of this module.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section yields">
      <div class="mkapi-section-name yields">
          <span class="mkapi-section-name-body yields">Yields</span> <span class="mkapi-item-type">(torch.Tensor)</span>
        </div>
      <div class="mkapi-section-body yields"><p>module buffer</p></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Example::</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">buf</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">buffers</span><span class="p">():</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="n">buf</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="s1">&#39;&gt; (20L,)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="s1">&#39;&gt; (20L, 1L, 5L, 5L)</span>
</code></pre></div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.named_buffers">
<div class='mkapi-object-container'>
  <div class="mkapi-object generator code">
    <div class="mkapi-object-kind generator">generator</div>
    <h4 id="torchnnmodulesmodulemodulenamed_buffers" class="mkapi-object-body generator"><code class="mkapi-object-name">named_buffers</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">prefix=&#39;&#39;</code>, <code class="mkapi-object-signature">recurse=True</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.named_buffers" title="Source for torch.nn.modules.module.Module.named_buffers">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Returns an iterator over module buffers, yielding both the
name of the buffer as well as the buffer itself.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">prefix</code>
<span class="mkapi-item-type">(str)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">prefix to prepend to all buffer names.</span></li>

<li><code class="mkapi-item-name">recurse</code>
<span class="mkapi-item-type">(bool)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True, then yields buffers of this module
and all submodules. Otherwise, yields only buffers that
are direct members of this module.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section yields">
      <div class="mkapi-section-name yields">
          <span class="mkapi-section-name-body yields">Yields</span> <span class="mkapi-item-type">(string, torch.Tensor)</span>
        </div>
      <div class="mkapi-section-body yields"><p>Tuple containing the name and buffer</p></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Example::</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">buf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">named_buffers</span><span class="p">():</span>
<span class="o">&gt;&gt;&gt;</span>    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;running_var&#39;</span><span class="p">]:</span>
<span class="o">&gt;&gt;&gt;</span>        <span class="nb">print</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
</code></pre></div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.children">
<div class='mkapi-object-container'>
  <div class="mkapi-object generator code">
    <div class="mkapi-object-kind generator">generator</div>
    <h4 id="torchnnmodulesmodulemodulechildren" class="mkapi-object-body generator"><code class="mkapi-object-name">children</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.children" title="Source for torch.nn.modules.module.Module.children">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Returns an iterator over immediate children modules.</p></div>
    </div>
  <div class="mkapi-section yields">
      <div class="mkapi-section-name yields">
          <span class="mkapi-section-name-body yields">Yields</span> <span class="mkapi-item-type">(Module)</span>
        </div>
      <div class="mkapi-section-body yields"><p>a child module</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.named_children">
<div class='mkapi-object-container'>
  <div class="mkapi-object generator code">
    <div class="mkapi-object-kind generator">generator</div>
    <h4 id="torchnnmodulesmodulemodulenamed_children" class="mkapi-object-body generator"><code class="mkapi-object-name">named_children</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.named_children" title="Source for torch.nn.modules.module.Module.named_children">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Returns an iterator over immediate children modules, yielding both
the name of the module as well as the module itself.</p></div>
    </div>
  <div class="mkapi-section yields">
      <div class="mkapi-section-name yields">
          <span class="mkapi-section-name-body yields">Yields</span> <span class="mkapi-item-type">(string, Module)</span>
        </div>
      <div class="mkapi-section-body yields"><p>Tuple containing a name and child module</p></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Example::</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">named_children</span><span class="p">():</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;conv4&#39;</span><span class="p">,</span> <span class="s1">&#39;conv5&#39;</span><span class="p">]:</span>
<span class="o">&gt;&gt;&gt;</span>         <span class="nb">print</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
</code></pre></div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.modules">
<div class='mkapi-object-container'>
  <div class="mkapi-object generator code">
    <div class="mkapi-object-kind generator">generator</div>
    <h4 id="torchnnmodulesmodulemodulemodules" class="mkapi-object-body generator"><code class="mkapi-object-name">modules</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.modules" title="Source for torch.nn.modules.module.Module.modules">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Returns an iterator over all modules in the network.</p></div>
    </div>
  <div class="mkapi-section yields">
      <div class="mkapi-section-name yields">
          <span class="mkapi-section-name-body yields">Yields</span> <span class="mkapi-item-type">(Module)</span>
        </div>
      <div class="mkapi-section-body yields"><p>a module in the network</p></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Duplicate modules are returned only once. In the following
example, <code>l</code> will be returned only once.</p>
</div></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Example::</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">modules</span><span class="p">()):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</code></pre></div>
<p>0 -&gt; Sequential(
  (0): Linear(in_features=2, out_features=2, bias=True)
  (1): Linear(in_features=2, out_features=2, bias=True)
)
1 -&gt; Linear(in_features=2, out_features=2, bias=True)</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.named_modules">
<div class='mkapi-object-container'>
  <div class="mkapi-object generator code">
    <div class="mkapi-object-kind generator">generator</div>
    <h4 id="torchnnmodulesmodulemodulenamed_modules" class="mkapi-object-body generator"><code class="mkapi-object-name">named_modules</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">memo=None</code>, <code class="mkapi-object-signature">prefix=&#39;&#39;</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.named_modules" title="Source for torch.nn.modules.module.Module.named_modules">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Returns an iterator over all modules in the network, yielding
both the name of the module as well as the module itself.</p></div>
    </div>
  <div class="mkapi-section yields">
      <div class="mkapi-section-name yields">
          <span class="mkapi-section-name-body yields">Yields</span> <span class="mkapi-item-type">(string, Module)</span>
        </div>
      <div class="mkapi-section-body yields"><p>Tuple of name and module</p></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Duplicate modules are returned only once. In the following
example, <code>l</code> will be returned only once.</p>
</div></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Example::</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">named_modules</span><span class="p">()):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</code></pre></div>
<p>0 -&gt; ('', Sequential(
  (0): Linear(in_features=2, out_features=2, bias=True)
  (1): Linear(in_features=2, out_features=2, bias=True)
))
1 -&gt; ('0', Linear(in_features=2, out_features=2, bias=True))</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.train">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="torchnnmodulesmodulemoduletrain" class="mkapi-object-body method"><code class="mkapi-object-name">train</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">mode=True</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.train" title="Source for torch.nn.modules.module.Module.train">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Sets the module in training mode.</p>
<p>This has any effect only on certain modules. See documentations of
particular modules for details of their behaviors in training/evaluation
mode, if they are affected, e.g. :class:<code>Dropout</code>, :class:<code>BatchNorm</code>,
etc.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">mode</code>
<span class="mkapi-item-type">(bool)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">whether to set training mode (<code>True</code>) or evaluation
mode (<code>False</code>). Default: <code>True</code>.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> <span class="mkapi-item-type">(Module)</span>
        </div>
      <div class="mkapi-section-body returns"><p>self</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.eval">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="torchnnmodulesmodulemoduleeval" class="mkapi-object-body method"><code class="mkapi-object-name">eval</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.eval" title="Source for torch.nn.modules.module.Module.eval">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Sets the module in evaluation mode.</p>
<p>This has any effect only on certain modules. See documentations of
particular modules for details of their behaviors in training/evaluation
mode, if they are affected, e.g. :class:<code>Dropout</code>, :class:<code>BatchNorm</code>,
etc.</p>
<p>This is equivalent with :meth:<code>self.train(False) &lt;torch.nn.Module.train&gt;</code>.</p></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> <span class="mkapi-item-type">(Module)</span>
        </div>
      <div class="mkapi-section-body returns"><p>self</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.requires_grad_">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="torchnnmodulesmodulemodulerequires_grad_" class="mkapi-object-body method"><code class="mkapi-object-name">requires_grad_</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">requires_grad=True</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.requires_grad_" title="Source for torch.nn.modules.module.Module.requires_grad_">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Change if autograd should record operations on parameters in this
module.</p>
<p>This method sets the parameters' :attr:<code>requires_grad</code> attributes
in-place.</p>
<p>This method is helpful for freezing part of the module for finetuning
or training parts of a model individually (e.g., GAN training).</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">requires_grad</code>
<span class="mkapi-item-type">(bool)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">whether autograd should record operations on
parameters in this module. Default: <code>True</code>.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> <span class="mkapi-item-type">(Module)</span>
        </div>
      <div class="mkapi-section-body returns"><p>self</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.zero_grad">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="torchnnmodulesmodulemodulezero_grad" class="mkapi-object-body method"><code class="mkapi-object-name">zero_grad</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.zero_grad" title="Source for torch.nn.modules.module.Module.zero_grad">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Sets gradients of all model parameters to zero.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="torch.nn.modules.module.Module.extra_repr">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="torchnnmodulesmodulemoduleextra_repr" class="mkapi-object-body method"><code class="mkapi-object-name">extra_repr</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/torch.nn.modules.module/#torch.nn.modules.module.Module.extra_repr" title="Source for torch.nn.modules.module.Module.extra_repr">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Set the extra representation of the module</p>
<p>To print customized extra information, you should reimplement
this method in your own modules. Both single-line and multi-line
strings are acceptable.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.setup">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookssetup" class="mkapi-object-body method"><code class="mkapi-object-name">setup</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">stage</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.setup" title="Source for pytorch_lightning.core.hooks.ModelHooks.setup">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called at the beginning of fit and test.
This is a good hook when you need to build models dynamically or adjust something about them.
This hook is called on every process when using DDP.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">stage</code>
<span class="mkapi-item-type">(str)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">either 'fit' or 'test'</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Example::</p>
<pre><code>class LitModel(...):
    def __init__(self):
        self.l1 = None

    def prepare_data(self):
        download_data()
        tokenize()

        # don't do this
        self.something = else

    def setup(stage):
        data = Load_data(...)
        self.l1 = nn.Linear(28, data.num_classes)
</code></pre></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.teardown">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhooksteardown" class="mkapi-object-body method"><code class="mkapi-object-name">teardown</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">stage</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.teardown" title="Source for pytorch_lightning.core.hooks.ModelHooks.teardown">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called at the end of fit and test.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">stage</code>
<span class="mkapi-item-type">(str)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">either 'fit' or 'test'</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_fit_start">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_fit_start" class="mkapi-object-body method"><code class="mkapi-object-name">on_fit_start</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_fit_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_fit_start">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called at the very beginning of fit.
If on DDP it is called on every process</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_fit_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_fit_end" class="mkapi-object-body method"><code class="mkapi-object-name">on_fit_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_fit_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_fit_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called at the very end of fit.
If on DDP it is called on every process</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_train_start">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_train_start" class="mkapi-object-body method"><code class="mkapi-object-name">on_train_start</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_train_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_train_start">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called at the beginning of training before sanity check.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_train_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_train_end" class="mkapi-object-body method"><code class="mkapi-object-name">on_train_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_train_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_train_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called at the end of training before logger experiment is closed.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_pretrain_routine_start">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_pretrain_routine_start" class="mkapi-object-body method"><code class="mkapi-object-name">on_pretrain_routine_start</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_pretrain_routine_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_pretrain_routine_start">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called at the beginning of the pretrain routine (between fit and train start).</p>
<ul>
<li>fit</li>
<li>pretrain_routine start</li>
<li>pretrain_routine end</li>
<li>training_start</li>
</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_pretrain_routine_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_pretrain_routine_end" class="mkapi-object-body method"><code class="mkapi-object-name">on_pretrain_routine_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_pretrain_routine_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_pretrain_routine_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called at the end of the pretrain routine (between fit and train start).</p>
<ul>
<li>fit</li>
<li>pretrain_routine start</li>
<li>pretrain_routine end</li>
<li>training_start</li>
</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_train_batch_start">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_train_batch_start" class="mkapi-object-body method"><code class="mkapi-object-name">on_train_batch_start</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">batch_idx</code>, <code class="mkapi-object-signature">dataloader_idx</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_train_batch_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_train_batch_start">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called in the training loop before anything happens for that batch.</p>
<p>If you return -1 here, you will skip training for the rest of the current epoch.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">batch</code>
<span class="mkapi-item-type">(any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The batched data as it is returned by the training DataLoader.</span></li>

<li><code class="mkapi-item-name">batch_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the index of the batch</span></li>

<li><code class="mkapi-item-name">dataloader_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the index of the dataloader</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_train_batch_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_train_batch_end" class="mkapi-object-body method"><code class="mkapi-object-name">on_train_batch_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">outputs</code>, <code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">batch_idx</code>, <code class="mkapi-object-signature">dataloader_idx</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_train_batch_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_train_batch_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called in the training loop after the batch.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">outputs</code>
<span class="mkapi-item-type">(any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The outputs of training_step_end(training_step(x))</span></li>

<li><code class="mkapi-item-name">batch</code>
<span class="mkapi-item-type">(any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The batched data as it is returned by the training DataLoader.</span></li>

<li><code class="mkapi-item-name">batch_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the index of the batch</span></li>

<li><code class="mkapi-item-name">dataloader_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the index of the dataloader</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_validation_model_eval">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_validation_model_eval" class="mkapi-object-body method"><code class="mkapi-object-name">on_validation_model_eval</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_validation_model_eval" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_validation_model_eval">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Sets the model to eval during the val loop</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_validation_model_train">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_validation_model_train" class="mkapi-object-body method"><code class="mkapi-object-name">on_validation_model_train</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_validation_model_train" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_validation_model_train">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Sets the model to train during the val loop</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_validation_batch_start">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_validation_batch_start" class="mkapi-object-body method"><code class="mkapi-object-name">on_validation_batch_start</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">batch_idx</code>, <code class="mkapi-object-signature">dataloader_idx</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_validation_batch_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_validation_batch_start">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called in the validation loop before anything happens for that batch.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">batch</code>
<span class="mkapi-item-type">(any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The batched data as it is returned by the validation DataLoader.</span></li>

<li><code class="mkapi-item-name">batch_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the index of the batch</span></li>

<li><code class="mkapi-item-name">dataloader_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the index of the dataloader</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_validation_batch_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_validation_batch_end" class="mkapi-object-body method"><code class="mkapi-object-name">on_validation_batch_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">outputs</code>, <code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">batch_idx</code>, <code class="mkapi-object-signature">dataloader_idx</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_validation_batch_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_validation_batch_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called in the validation loop after the batch.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">outputs</code>
<span class="mkapi-item-type">(any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The outputs of validation_step_end(validation_step(x))</span></li>

<li><code class="mkapi-item-name">batch</code>
<span class="mkapi-item-type">(any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The batched data as it is returned by the validation DataLoader.</span></li>

<li><code class="mkapi-item-name">batch_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the index of the batch</span></li>

<li><code class="mkapi-item-name">dataloader_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the index of the dataloader</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_test_batch_start">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_test_batch_start" class="mkapi-object-body method"><code class="mkapi-object-name">on_test_batch_start</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">batch_idx</code>, <code class="mkapi-object-signature">dataloader_idx</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_test_batch_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_test_batch_start">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called in the test loop before anything happens for that batch.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">batch</code>
<span class="mkapi-item-type">(any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The batched data as it is returned by the test DataLoader.</span></li>

<li><code class="mkapi-item-name">batch_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the index of the batch</span></li>

<li><code class="mkapi-item-name">dataloader_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the index of the dataloader</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_test_batch_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_test_batch_end" class="mkapi-object-body method"><code class="mkapi-object-name">on_test_batch_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">outputs</code>, <code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">batch_idx</code>, <code class="mkapi-object-signature">dataloader_idx</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_test_batch_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_test_batch_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called in the test loop after the batch.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">outputs</code>
<span class="mkapi-item-type">(any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The outputs of test_step_end(test_step(x))</span></li>

<li><code class="mkapi-item-name">batch</code>
<span class="mkapi-item-type">(any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The batched data as it is returned by the test DataLoader.</span></li>

<li><code class="mkapi-item-name">batch_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the index of the batch</span></li>

<li><code class="mkapi-item-name">dataloader_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the index of the dataloader</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_test_model_eval">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_test_model_eval" class="mkapi-object-body method"><code class="mkapi-object-name">on_test_model_eval</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_test_model_eval" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_test_model_eval">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Sets the model to eval during the test loop</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_test_model_train">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_test_model_train" class="mkapi-object-body method"><code class="mkapi-object-name">on_test_model_train</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_test_model_train" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_test_model_train">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Sets the model to train during the test loop</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_epoch_start">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_epoch_start" class="mkapi-object-body method"><code class="mkapi-object-name">on_epoch_start</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_epoch_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_epoch_start">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called in the training loop at the very beginning of the epoch.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_train_epoch_start">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_train_epoch_start" class="mkapi-object-body method"><code class="mkapi-object-name">on_train_epoch_start</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_train_epoch_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_train_epoch_start">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called in the training loop at the very beginning of the epoch.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_train_epoch_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_train_epoch_end" class="mkapi-object-body method"><code class="mkapi-object-name">on_train_epoch_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">outputs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_train_epoch_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_train_epoch_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called in the training loop at the very end of the epoch.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_validation_epoch_start">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_validation_epoch_start" class="mkapi-object-body method"><code class="mkapi-object-name">on_validation_epoch_start</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_validation_epoch_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_validation_epoch_start">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called in the validation loop at the very beginning of the epoch.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_validation_epoch_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_validation_epoch_end" class="mkapi-object-body method"><code class="mkapi-object-name">on_validation_epoch_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_validation_epoch_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_validation_epoch_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called in the validation loop at the very end of the epoch.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_test_epoch_start">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_test_epoch_start" class="mkapi-object-body method"><code class="mkapi-object-name">on_test_epoch_start</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_test_epoch_start" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_test_epoch_start">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called in the test loop at the very beginning of the epoch.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_test_epoch_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_test_epoch_end" class="mkapi-object-body method"><code class="mkapi-object-name">on_test_epoch_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_test_epoch_end" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_test_epoch_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called in the test loop at the very end of the epoch.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_before_zero_grad">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_before_zero_grad" class="mkapi-object-body method"><code class="mkapi-object-name">on_before_zero_grad</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">optimizer</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_before_zero_grad" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_before_zero_grad">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called after optimizer.step() and before optimizer.zero_grad().</p>
<p>Called in the training loop after taking an optimizer step and before zeroing grads.
Good place to inspect weight information with weights updated.</p>
<p>This is where it is called::</p>
<pre><code>for optimizer in optimizers:
    optimizer.step()
    model.on_before_zero_grad(optimizer) # &lt; ---- called here
    optimizer.zero_grad()
</code></pre></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">optimizer</code>
<span class="mkapi-item-type">(Optimizer)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The optimizer for which grads should be zeroed.</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.ModelHooks.on_after_backward">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksmodelhookson_after_backward" class="mkapi-object-body method"><code class="mkapi-object-name">on_after_backward</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.ModelHooks.on_after_backward" title="Source for pytorch_lightning.core.hooks.ModelHooks.on_after_backward">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called in the training loop after loss.backward() and before optimizers do anything.
This is the ideal place to inspect or log gradient information.</p>
<p>Example::</p>
<pre><code>def on_after_backward(self):
    # example to inspect gradient information in tensorboard
    if self.trainer.global_step % 25 == 0:  # don't make the tf file huge
        params = self.state_dict()
        for k, v in params.items():
            grads = v
            name = k
            self.logger.experiment.add_histogram(tag=name, values=grads,
                                                 global_step=self.trainer.global_step)
</code></pre></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.DataHooks.prepare_data">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksdatahooksprepare_data" class="mkapi-object-body method"><code class="mkapi-object-name">prepare_data</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.DataHooks.prepare_data" title="Source for pytorch_lightning.core.hooks.DataHooks.prepare_data">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Use this to download and prepare data.</p>
<p>.. warning:: DO NOT set state to the model (use <code>setup</code> instead)
    since this is NOT called on every GPU in DDP/TPU</p>
<p>Example::</p>
<pre><code>def prepare_data(self):
    # good
    download_data()
    tokenize()
    etc()

    # bad
    self.split = data_split
    self.some_state = some_other_state()
</code></pre>
<p>In DDP prepare_data can be called in two ways (using Trainer(prepare_data_per_node)):</p>
<ol>
<li>Once per node. This is the default and is only called on LOCAL_RANK=0.</li>
<li>Once in total. Only called on GLOBAL_RANK=0.</li>
</ol>
<p>Example::</p>
<pre><code># DEFAULT
# called once per node on LOCAL_RANK=0 of that node
Trainer(prepare_data_per_node=True)

# call on GLOBAL_RANK=0 (great for shared file systems)
Trainer(prepare_data_per_node=False)
</code></pre>
<p>This is called before requesting the dataloaders:</p>
<p>.. code-block:: python</p>
<pre><code>model.prepare_data()
    if ddp/tpu: init()
model.setup(stage)
model.train_dataloader()
model.val_dataloader()
model.test_dataloader()
</code></pre></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.DataHooks.train_dataloader">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksdatahookstrain_dataloader" class="mkapi-object-body method"><code class="mkapi-object-name">train_dataloader</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code><span class="mkapi-item-type"> &#x2192; DataLoader</span></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.DataHooks.train_dataloader" title="Source for pytorch_lightning.core.hooks.DataHooks.train_dataloader">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Implement a PyTorch DataLoader for training.</p>
<p>Return:
    Single PyTorch :class:<code>~torch.utils.data.DataLoader</code>.</p>
<p>The dataloader you return will not be called every epoch unless you set
:paramref:<code>~pytorch_lightning.trainer.Trainer.reload_dataloaders_every_epoch</code> to <code>True</code>.</p>
<p>For data processing use the following pattern:</p>
<pre><code>- download in :meth:`prepare_data`
- process and split in :meth:`setup`
</code></pre>
<p>However, the above are only necessary for distributed processing.</p>
<p>.. warning:: do not assign state in prepare_data</p>
<ul>
<li>:meth:<code>~pytorch_lightning.trainer.Trainer.fit</code></li>
<li>...</li>
<li>:meth:<code>prepare_data</code></li>
<li>:meth:<code>setup</code></li>
<li>:meth:<code>train_dataloader</code></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lightning adds the correct sampler for distributed and arbitrary hardware.
There is no need to set it yourself.</p>
</div></div>
    </div>
  <div class="mkapi-section example">
      <div class="mkapi-section-name example">
          <span class="mkapi-section-name-body example">Example</span> 
        </div>
      <div class="mkapi-section-body example"><p>.. code-block:: python</p>
<pre><code>def train_dataloader(self):
    transform = transforms.Compose([transforms.ToTensor(),
                                    transforms.Normalize((0.5,), (1.0,))])
    dataset = MNIST(root='/path/to/mnist/', train=True, transform=transform,
                    download=True)
    loader = torch.utils.data.DataLoader(
        dataset=dataset,
        batch_size=self.batch_size,
        shuffle=True
    )
    return loader
</code></pre></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.DataHooks.test_dataloader">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksdatahookstest_dataloader" class="mkapi-object-body method"><code class="mkapi-object-name">test_dataloader</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code><span class="mkapi-item-type"> &#x2192; Union(dataloader, list of dataloader)</span></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.DataHooks.test_dataloader" title="Source for pytorch_lightning.core.hooks.DataHooks.test_dataloader">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Implement one or multiple PyTorch DataLoaders for testing.</p>
<p>The dataloader you return will not be called every epoch unless you set
:paramref:<code>~pytorch_lightning.trainer.Trainer.reload_dataloaders_every_epoch</code> to <code>True</code>.</p>
<p>For data processing use the following pattern:</p>
<pre><code>- download in :meth:`prepare_data`
- process and split in :meth:`setup`
</code></pre>
<p>However, the above are only necessary for distributed processing.</p>
<p>.. warning:: do not assign state in prepare_data</p>
<ul>
<li>:meth:<code>~pytorch_lightning.trainer.Trainer.fit</code></li>
<li>...</li>
<li>:meth:<code>prepare_data</code></li>
<li>:meth:<code>setup</code></li>
<li>:meth:<code>train_dataloader</code></li>
<li>:meth:<code>val_dataloader</code></li>
<li>:meth:<code>test_dataloader</code></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lightning adds the correct sampler for distributed and arbitrary hardware.
There is no need to set it yourself.</p>
</div></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    Single or multiple PyTorch DataLoaders.</p></div>
    </div>
  <div class="mkapi-section example">
      <div class="mkapi-section-name example">
          <span class="mkapi-section-name-body example">Example</span> 
        </div>
      <div class="mkapi-section-body example"><p>.. code-block:: python</p>
<pre><code>def test_dataloader(self):
    transform = transforms.Compose([transforms.ToTensor(),
                                    transforms.Normalize((0.5,), (1.0,))])
    dataset = MNIST(root='/path/to/mnist/', train=False, transform=transform,
                    download=True)
    loader = torch.utils.data.DataLoader(
        dataset=dataset,
        batch_size=self.batch_size,
        shuffle=False
    )

    return loader

# can also return multiple dataloaders
def test_dataloader(self):
    return [loader_a, loader_b, ..., loader_n]
</code></pre></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don't need a test dataset and a :meth:<code>test_step</code>, you don't need to implement
this method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the case where you return multiple test dataloaders, the :meth:<code>test_step</code>
will have an argument <code>dataloader_idx</code> which matches the order here.</p>
</div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.DataHooks.val_dataloader">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksdatahooksval_dataloader" class="mkapi-object-body method"><code class="mkapi-object-name">val_dataloader</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code><span class="mkapi-item-type"> &#x2192; Union(dataloader, list of dataloader)</span></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.DataHooks.val_dataloader" title="Source for pytorch_lightning.core.hooks.DataHooks.val_dataloader">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Implement one or multiple PyTorch DataLoaders for validation.</p>
<p>The dataloader you return will not be called every epoch unless you set
:paramref:<code>~pytorch_lightning.trainer.Trainer.reload_dataloaders_every_epoch</code> to <code>True</code>.</p>
<p>It's recommended that all data downloads and preparation happen in :meth:<code>prepare_data</code>.</p>
<ul>
<li>:meth:<code>~pytorch_lightning.trainer.Trainer.fit</code></li>
<li>...</li>
<li>:meth:<code>prepare_data</code></li>
<li>:meth:<code>train_dataloader</code></li>
<li>:meth:<code>val_dataloader</code></li>
<li>:meth:<code>test_dataloader</code></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lightning adds the correct sampler for distributed and arbitrary hardware
There is no need to set it yourself.</p>
</div></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    Single or multiple PyTorch DataLoaders.</p></div>
    </div>
  <div class="mkapi-section examples">
      <div class="mkapi-section-name examples">
          <span class="mkapi-section-name-body examples">Examples</span> 
        </div>
      <div class="mkapi-section-body examples"><p>.. code-block:: python</p>
<pre><code>def val_dataloader(self):
    transform = transforms.Compose([transforms.ToTensor(),
                                    transforms.Normalize((0.5,), (1.0,))])
    dataset = MNIST(root='/path/to/mnist/', train=False,
                    transform=transform, download=True)
    loader = torch.utils.data.DataLoader(
        dataset=dataset,
        batch_size=self.batch_size,
        shuffle=False
    )

    return loader

# can also return multiple dataloaders
def val_dataloader(self):
    return [loader_a, loader_b, ..., loader_n]
</code></pre></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don't need a validation dataset and a :meth:<code>validation_step</code>, you don't need to
implement this method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the case where you return multiple validation dataloaders, the :meth:<code>validation_step</code>
will have an argument <code>dataloader_idx</code> which matches the order here.</p>
</div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.hooks.DataHooks.transfer_batch_to_device">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorehooksdatahookstransfer_batch_to_device" class="mkapi-object-body method"><code class="mkapi-object-name">transfer_batch_to_device</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">device=None</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.hooks/#pytorch_lightning.core.hooks.DataHooks.transfer_batch_to_device" title="Source for pytorch_lightning.core.hooks.DataHooks.transfer_batch_to_device">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Override this hook if your :class:<code>~torch.utils.data.DataLoader</code> returns tensors
wrapped in a custom data structure.</p>
<p>The data types listed below (and any arbitrary nesting of them) are supported out of the box:</p>
<ul>
<li>:class:<code>torch.Tensor</code> or anything that implements <code>.to(...)</code></li>
<li>:class:<code>list</code></li>
<li>:class:<code>dict</code></li>
<li>:class:<code>tuple</code></li>
<li>:class:<code>torchtext.data.batch.Batch</code></li>
</ul>
<p>For anything else, you need to define how the data is moved to the target device (CPU, GPU, TPU, ...).</p>
<p>Example::</p>
<pre><code>def transfer_batch_to_device(self, batch, device)
    if isinstance(batch, CustomBatch):
        # move all tensors in your custom data structure to the device
        batch.samples = batch.samples.to(device)
        batch.targets = batch.targets.to(device)
    else:
        batch = super().transfer_batch_to_device(data, device)
    return batch
</code></pre></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">batch</code>
<span class="mkapi-item-type">(any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">A batch of data that needs to be transferred to a new device.</span></li>

<li><code class="mkapi-item-name">device</code>
<span class="mkapi-item-type">(device, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The target device as defined in PyTorch.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> <span class="mkapi-item-type">(any)</span>
        </div>
      <div class="mkapi-section-body returns"><p>A reference to the data on the new device.</p></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><div class="admonition note">
<p class="admonition-title">Note</p>
<p>This hook should only transfer the data and not modify it, nor should it move the data to
any other device than the one passed in as argument (unless you know what you are doing).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This hook only runs on single GPU training (no data-parallel). If you need multi-GPU support
for your custom batch objects, you need to define your custom
:class:<code>~torch.nn.parallel.DistributedDataParallel</code> or
:class:<code>~pytorch_lightning.overrides.data_parallel.LightningDistributedDataParallel</code> and
override :meth:<code>~pytorch_lightning.core.lightning.LightningModule.configure_ddp</code>.</p>
</div></div>
    </div>
  <div class="mkapi-section see-also">
      <div class="mkapi-section-name see-also">
          <span class="mkapi-section-name-body see-also">See Also</span> 
        </div>
      <div class="mkapi-section-body see-also"><ul>
<li>:func:<code>~pytorch_lightning.utilities.apply_func.move_data_to_device</code></li>
<li>:func:<code>~pytorch_lightning.utilities.apply_func.apply_to_collection</code></li>
</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.saving.ModelIO.load_from_checkpoint">
<div class='mkapi-object-container'>
  <div class="mkapi-object classmethod code">
    <div class="mkapi-object-kind classmethod">classmethod</div>
    <h4 id="pytorch_lightningcoresavingmodelioload_from_checkpoint" class="mkapi-object-body classmethod"><code class="mkapi-object-name">load_from_checkpoint</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">checkpoint_path</code>, <code class="mkapi-object-signature">map_location=None</code>, <code class="mkapi-object-signature">hparams_file=None</code>, <code class="mkapi-object-signature">strict=True</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.saving/#pytorch_lightning.core.saving.ModelIO.load_from_checkpoint" title="Source for pytorch_lightning.core.saving.ModelIO.load_from_checkpoint">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Primary way of loading a model from a checkpoint. When Lightning saves a checkpoint
it stores the arguments passed to <code>__init__</code>  in the checkpoint under <code>hyper_parameters</code></p>
<p>Any arguments specified through *args and **kwargs will override args stored in <code>hyper_parameters</code>.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">checkpoint_path</code>
<span class="mkapi-item-type">(str or IO)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Path to checkpoint. This can also be a URL, or file-like object</span></li>

<li><code class="mkapi-item-name">map_location</code>
<span class="mkapi-item-type">(Union(dict(str: str), str, device, int, callable, nonetype), optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">If your checkpoint saved a GPU model and you now load on CPUs
or a different number of GPUs, use this to map to the new setup.
The behaviour is the same as in :func:<code>torch.load</code>.</span></li>

<li><code class="mkapi-item-name">hparams_file</code>
<span class="mkapi-item-type">(str, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Optional path to a .yaml file with hierarchical structure
as in this example::<br>
<pre><code>drop_prob: 0.2
dataloader:
    batch_size: 32
</code></pre>
You most likely won't need this since Lightning will always save the hyperparameters
to the checkpoint.
However, if your checkpoint weights don't have the hyperparameters saved,
use this method to pass in a .yaml file with the hparams you'd like to use.
These will be converted into a :class:<code>~dict</code> and passed into your
:class:<code>LightningModule</code> for use.<br>
If your model's <code>hparams</code> argument is :class:<code>~argparse.Namespace</code>
and .yaml file has hierarchical structure, you need to refactor your model to treat
<code>hparams</code> as :class:<code>~dict</code>.</span></li>

<li><code class="mkapi-item-name">strict</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Whether to strictly enforce that the keys in :attr:<code>checkpoint_path</code> match the keys
returned by this module's state dict. Default: <code>True</code>.</span></li>


<li><code class="mkapi-item-name">kwargs</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Any extra keyword args needed to init the model. Can also be used to override saved
hyperparameter values.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    :class:<code>LightningModule</code> with loaded weights and hyperparameters (if available).</p></div>
    </div>
  <div class="mkapi-section example">
      <div class="mkapi-section-name example">
          <span class="mkapi-section-name-body example">Example</span> 
        </div>
      <div class="mkapi-section-body example"><p>.. code-block:: python</p>
<pre><code># load weights without mapping ...
MyLightningModule.load_from_checkpoint('path/to/checkpoint.ckpt')

# or load weights mapping all weights from GPU 1 to GPU 0 ...
map_location = {'cuda:1':'cuda:0'}
MyLightningModule.load_from_checkpoint(
    'path/to/checkpoint.ckpt',
    map_location=map_location
)

# or load weights and hyperparameters from separate files.
MyLightningModule.load_from_checkpoint(
    'path/to/checkpoint.ckpt',
    hparams_file='/path/to/hparams_file.yaml'
)

# override some of the params with new values
MyLightningModule.load_from_checkpoint(
    PATH,
    num_layers=128,
    pretrained_ckpt_path: NEW_PATH,
)

# predict
pretrained_model.eval()
pretrained_model.freeze()
y_hat = pretrained_model(x)
</code></pre></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.saving.ModelIO.on_load_checkpoint">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcoresavingmodelioon_load_checkpoint" class="mkapi-object-body method"><code class="mkapi-object-name">on_load_checkpoint</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">checkpoint</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.saving/#pytorch_lightning.core.saving.ModelIO.on_load_checkpoint" title="Source for pytorch_lightning.core.saving.ModelIO.on_load_checkpoint">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Do something with the checkpoint.
Gives model a chance to load something before <code>state_dict</code> is restored.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">checkpoint</code>
<span class="mkapi-item-type">(dict(str: any))</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">A dictionary with variables from the checkpoint.</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.saving.ModelIO.on_save_checkpoint">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcoresavingmodelioon_save_checkpoint" class="mkapi-object-body method"><code class="mkapi-object-name">on_save_checkpoint</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">checkpoint</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.saving/#pytorch_lightning.core.saving.ModelIO.on_save_checkpoint" title="Source for pytorch_lightning.core.saving.ModelIO.on_save_checkpoint">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Give the model a chance to add something to the checkpoint.
<code>state_dict</code> is already there.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">checkpoint</code>
<span class="mkapi-item-type">(dict(str: any))</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">A dictionary in which you can save variables to save in a checkpoint.
Contents need to be pickleable.</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.saving.ModelIO.on_hpc_save">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcoresavingmodelioon_hpc_save" class="mkapi-object-body method"><code class="mkapi-object-name">on_hpc_save</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">checkpoint</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.saving/#pytorch_lightning.core.saving.ModelIO.on_hpc_save" title="Source for pytorch_lightning.core.saving.ModelIO.on_hpc_save">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Hook to do whatever you need right before Slurm manager saves the model.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">checkpoint</code>
<span class="mkapi-item-type">(dict(str: any))</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">A dictionary in which you can save variables to save in a checkpoint.
Contents need to be pickleable.</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.saving.ModelIO.on_hpc_load">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcoresavingmodelioon_hpc_load" class="mkapi-object-body method"><code class="mkapi-object-name">on_hpc_load</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">checkpoint</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.saving/#pytorch_lightning.core.saving.ModelIO.on_hpc_load" title="Source for pytorch_lightning.core.saving.ModelIO.on_hpc_load">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Hook to do whatever you need right before Slurm manager loads the model.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">checkpoint</code>
<span class="mkapi-item-type">(dict(str: any))</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">A dictionary with variables from the checkpoint.</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.grads.GradInformation.grad_norm">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcoregradsgradinformationgrad_norm" class="mkapi-object-body method"><code class="mkapi-object-name">grad_norm</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">norm_type</code><code class="mkapi-object-parenthesis">)</code><span class="mkapi-item-type"> &#x2192; dict(str: float)</span></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.grads/#pytorch_lightning.core.grads.GradInformation.grad_norm" title="Source for pytorch_lightning.core.grads.GradInformation.grad_norm">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Compute each parameter's gradient's norm and their overall norm.</p>
<p>The overall norm is computed over all gradients together, as if they
were concatenated into a single vector.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">norm_type</code>
<span class="mkapi-item-type">(float, int, or str)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The type of the used p-norm, cast to float if necessary.
Can be <code>'inf'</code> for infinity norm.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    norms: The dictionary of p-norms of each parameter's gradient and
        a special entry for the total p-norm of the gradients viewed
        as a single vector.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.to">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixinto" class="mkapi-object-body method"><code class="mkapi-object-name">to</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.utilities.device_dtype_mixin/#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.to" title="Source for pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.to">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Moves and/or casts the parameters and buffers.</p>
<p>This can be called as
.. function:: to(device=None, dtype=None, non_blocking=False)
.. function:: to(dtype, non_blocking=False)
.. function:: to(tensor, non_blocking=False)
Its signature is similar to :meth:<code>torch.Tensor.to</code>, but only accepts
floating point desired :attr:<code>dtype</code> s. In addition, this method will
only cast the floating point parameters and buffers to :attr:<code>dtype</code>
(if given). The integral parameters and buffers will be moved
:attr:<code>device</code>, if that is given, but with dtypes unchanged. When
:attr:<code>non_blocking</code> is set, it tries to convert/move asynchronously
with respect to the host if possible, e.g., moving CPU Tensors with
pinned memory to CUDA devices.
See below for examples.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method modifies the module in-place.</p>
</div></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">


<li><code class="mkapi-item-name">device</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the desired device of the parameters
and buffers in this module</span></li>

<li><code class="mkapi-item-name">dtype</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the desired floating point type of
the floating point parameters and buffers in this module</span></li>

<li><code class="mkapi-item-name">tensor</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Tensor whose dtype and device are the desired
dtype and device for all parameters and buffers in this module</span></li>


</ul></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> <span class="mkapi-item-type">(Module)</span>
        </div>
      <div class="mkapi-section-body returns"><p>self</p></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Example::
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">ExampleModule</span><span class="p">(</span><span class="n">DeviceDtypeModuleMixin</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weight</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<span class="o">...</span>         <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">register_buffer</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">_</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">module</span> <span class="o">=</span> <span class="n">ExampleModule</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">module</span><span class="o">.</span><span class="n">weight</span> <span class="c1">#doctest: +ELLIPSIS</span>
<span class="n">tensor</span><span class="p">([[</span><span class="o">...</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">module</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
<span class="n">ExampleModule</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">module</span><span class="o">.</span><span class="n">weight</span> <span class="c1">#doctest: +ELLIPSIS</span>
<span class="n">tensor</span><span class="p">([[</span><span class="o">...</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cpu</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">module</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">cpu</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">half</span><span class="p">,</span> <span class="n">non_blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ExampleModule</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">module</span><span class="o">.</span><span class="n">weight</span> <span class="c1">#doctest: +ELLIPSIS</span>
<span class="n">tensor</span><span class="p">([[</span><span class="o">...</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">module</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">cpu</span><span class="p">)</span>
<span class="n">ExampleModule</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">module</span><span class="o">.</span><span class="n">weight</span> <span class="c1">#doctest: +ELLIPSIS</span>
<span class="n">tensor</span><span class="p">([[</span><span class="o">...</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">module</span><span class="o">.</span><span class="n">device</span>
<span class="n">device</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">module</span><span class="o">.</span><span class="n">dtype</span>
<span class="n">torch</span><span class="o">.</span><span class="n">float16</span>
</code></pre></div></p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.cuda">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixincuda" class="mkapi-object-body method"><code class="mkapi-object-name">cuda</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">device=None</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.utilities.device_dtype_mixin/#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.cuda" title="Source for pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.cuda">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Moves all model parameters and buffers to the GPU.
This also makes associated parameters and buffers different objects. So
it should be called before constructing optimizer if the module will
live on GPU while being optimized.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">device</code>
<span class="mkapi-item-type">(int, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if specified, all parameters will be
copied to that device</span></li>


</ul></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> <span class="mkapi-item-type">(Module)</span>
        </div>
      <div class="mkapi-section-body returns"><p>self</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.cpu">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixincpu" class="mkapi-object-body method"><code class="mkapi-object-name">cpu</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.utilities.device_dtype_mixin/#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.cpu" title="Source for pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.cpu">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Moves all model parameters and buffers to the CPU.</p></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> <span class="mkapi-item-type">(Module)</span>
        </div>
      <div class="mkapi-section-body returns"><p>self</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.type">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixintype" class="mkapi-object-body method"><code class="mkapi-object-name">type</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">dst_type</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.utilities.device_dtype_mixin/#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.type" title="Source for pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.type">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Casts all parameters and buffers to :attr:<code>dst_type</code>.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">dst_type</code>
<span class="mkapi-item-type">(type or string)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the desired type</span></li>


</ul></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> <span class="mkapi-item-type">(Module)</span>
        </div>
      <div class="mkapi-section-body returns"><p>self</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.float">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixinfloat" class="mkapi-object-body method"><code class="mkapi-object-name">float</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.utilities.device_dtype_mixin/#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.float" title="Source for pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.float">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Casts all floating point parameters and buffers to float datatype.</p></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> <span class="mkapi-item-type">(Module)</span>
        </div>
      <div class="mkapi-section-body returns"><p>self</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.double">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixindouble" class="mkapi-object-body method"><code class="mkapi-object-name">double</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.utilities.device_dtype_mixin/#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.double" title="Source for pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.double">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Casts all floating point parameters and buffers to <code>double</code> datatype.</p></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> <span class="mkapi-item-type">(Module)</span>
        </div>
      <div class="mkapi-section-body returns"><p>self</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.half">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningutilitiesdevice_dtype_mixindevicedtypemodulemixinhalf" class="mkapi-object-body method"><code class="mkapi-object-name">half</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.utilities.device_dtype_mixin/#pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.half" title="Source for pytorch_lightning.utilities.device_dtype_mixin.DeviceDtypeModuleMixin.half">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Casts all floating point parameters and buffers to <code>half</code> datatype.</p></div>
    </div>
  <div class="mkapi-section returns">
      <div class="mkapi-section-name returns">
          <span class="mkapi-section-name-body returns">Returns</span> <span class="mkapi-item-type">(Module)</span>
        </div>
      <div class="mkapi-section-body returns"><p>self</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="abc.ABCMeta">
<div class='mkapi-object-container'>
  <div class="mkapi-object class code top">
    <div class="mkapi-object-kind class top">class</div>
    <h4 id="abcabcmeta" class="mkapi-object-body class top"><code class="mkapi-object-prefix">abc.</code><code class="mkapi-object-name">ABCMeta</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">name</code>, <code class="mkapi-object-signature">bases</code>, <code class="mkapi-object-signature">namespace</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/abc/#abc.ABCMeta" title="Source for abc.ABCMeta">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Metaclass for defining Abstract Base Classes (ABCs).</p>
<p>Use this metaclass to create an ABC.  An ABC can be subclassed
directly, and then acts as a mix-in class.  You can also register
unrelated concrete classes (even built-in classes) and unrelated
ABCs as 'virtual subclasses' -- these and their descendants will
be considered subclasses of the registering ABC by the built-in
issubclass() function, but the registering ABC won't show up in
their MRO (Method Resolution Order) nor will method
implementations defined by the registering ABC be callable (not
even via super()).</p></div>
    </div>
  <div class="mkapi-section methods">
      <div class="mkapi-section-name methods">
          <span class="mkapi-section-name-body methods">Methods</span> 
        </div>
      <div class="mkapi-section-body methods"><ul class="mkapi-items">
<li class="staticmethod"><code class="mkapi-item-name"><a href="#abc.ABCMeta.__instancecheck__">__instancecheck__</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">cls</code>, <code class="mkapi-object-signature">instance</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Override for isinstance(instance, cls).<a class="mkapi-src-link" href="../source/abc/#abc.ABCMeta.__instancecheck__" title="Source for abc.ABCMeta.__instancecheck__">&lt;/&gt;</a></span></li>

<li class="staticmethod"><code class="mkapi-item-name"><a href="#abc.ABCMeta.__subclasscheck__">__subclasscheck__</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">cls</code>, <code class="mkapi-object-signature">subclass</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Override for issubclass(subclass, cls).<a class="mkapi-src-link" href="../source/abc/#abc.ABCMeta.__subclasscheck__" title="Source for abc.ABCMeta.__subclasscheck__">&lt;/&gt;</a></span></li>

<li class="staticmethod"><code class="mkapi-item-name"><a href="#abc.ABCMeta.register">register</a></code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">cls</code>, <code class="mkapi-object-signature">subclass</code><code class="mkapi-object-parenthesis">)</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Register a virtual subclass of an ABC.<a class="mkapi-src-link" href="../source/abc/#abc.ABCMeta.register" title="Source for abc.ABCMeta.register">&lt;/&gt;</a></span></li>


</ul></div>
    </div>
  </div>

  <div class="mkapi-members">
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="abc.ABCMeta.register">
<div class='mkapi-object-container'>
  <div class="mkapi-object staticmethod code">
    <div class="mkapi-object-kind staticmethod">staticmethod</div>
    <div class="mkapi-object-body staticmethod"><code class="mkapi-object-name">register</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">cls</code>, <code class="mkapi-object-signature">subclass</code><code class="mkapi-object-parenthesis">)</code></div>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/abc/#abc.ABCMeta.register" title="Source for abc.ABCMeta.register">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="abc.ABCMeta.__instancecheck__">
<div class='mkapi-object-container'>
  <div class="mkapi-object staticmethod code">
    <div class="mkapi-object-kind staticmethod">staticmethod</div>
    <div class="mkapi-object-body staticmethod"><code class="mkapi-object-name">__instancecheck__</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">cls</code>, <code class="mkapi-object-signature">instance</code><code class="mkapi-object-parenthesis">)</code></div>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/abc/#abc.ABCMeta.__instancecheck__" title="Source for abc.ABCMeta.__instancecheck__">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Override for isinstance(instance, cls).</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="abc.ABCMeta.__subclasscheck__">
<div class='mkapi-object-container'>
  <div class="mkapi-object staticmethod code">
    <div class="mkapi-object-kind staticmethod">staticmethod</div>
    <div class="mkapi-object-body staticmethod"><code class="mkapi-object-name">__subclasscheck__</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">cls</code>, <code class="mkapi-object-signature">subclass</code><code class="mkapi-object-parenthesis">)</code></div>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/abc/#abc.ABCMeta.__subclasscheck__" title="Source for abc.ABCMeta.__subclasscheck__">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Override for issubclass(subclass, cls).</p></div>
    </div>
  </div>

</div>
    </div>
  
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.print">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduleprint" class="mkapi-object-body method"><code class="mkapi-object-name">print</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.print" title="Source for pytorch_lightning.core.lightning.LightningModule.print">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Prints only from process 0. Use this in any distributed mode to log only once.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">*args</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The thing to print. Will be passed to Python's built-in print function.</span></li>

<li><code class="mkapi-item-name">**kwargs</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Will be passed to Python's built-in print function.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section example">
      <div class="mkapi-section-name example">
          <span class="mkapi-section-name-body example">Example</span> 
        </div>
      <div class="mkapi-section-body example"><p>n</p>
<p>:
)</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.log">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmodulelog" class="mkapi-object-body method"><code class="mkapi-object-name">log</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">name</code>, <code class="mkapi-object-signature">value</code>, <code class="mkapi-object-signature">prog_bar=False</code>, <code class="mkapi-object-signature">logger=True</code>, <code class="mkapi-object-signature">on_step=None</code>, <code class="mkapi-object-signature">on_epoch=None</code>, <code class="mkapi-object-signature">reduce_fx=&lt;built-in method mean of type object at 0x7f7ebfbd7860&gt;</code>, <code class="mkapi-object-signature">tbptt_reduce_fx=&lt;built-in method mean of type object at 0x7f7ebfbd7860&gt;</code>, <code class="mkapi-object-signature">tbptt_pad_token=0</code>, <code class="mkapi-object-signature">enable_graph=False</code>, <code class="mkapi-object-signature">sync_dist=False</code>, <code class="mkapi-object-signature">sync_dist_op=&#39;mean&#39;</code>, <code class="mkapi-object-signature">sync_dist_group=None</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.log" title="Source for pytorch_lightning.core.lightning.LightningModule.log">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Log a key, value</p>
<p>Example::</p>
<pre><code>self.log('train_loss', loss)
</code></pre>
<p>The default behavior per hook is as follows</p>
<p>.. csv-table:: <code>*</code> also applies to the test loop
   :header: "LightningMoule Hook", "on_step", "on_epoch", "prog_bar", "logger"
   :widths: 20, 10, 10, 10, 10</p>
<p>"training_step", "T", "F", "F", "T"
   "training_step_end", "T", "F", "F", "T"
   "training_epoch_end", "F", "T", "F", "T"
   "validation_step<em>", "F", "T", "F", "T"
   "validation_step_end</em>", "F", "T", "F", "T"
   "validation_epoch_end*", "F", "T", "F", "T"</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">name</code>
<span class="mkapi-item-type">(str)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">key name</span></li>

<li><code class="mkapi-item-name">value</code>
<span class="mkapi-item-type">(any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">value name</span></li>

<li><code class="mkapi-item-name">prog_bar</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True logs to the progress bar</span></li>

<li><code class="mkapi-item-name">logger</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True logs to the logger</span></li>

<li><code class="mkapi-item-name">on_step</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True logs at this step. None auto-logs at the training_step but not validation/test_step</span></li>

<li><code class="mkapi-item-name">on_epoch</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True logs epoch accumulated metrics. None auto-logs at the val/test step but not training_step</span></li>

<li><code class="mkapi-item-name">reduce_fx</code>
<span class="mkapi-item-type">(callable, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">reduction function over step values for end of epoch. Torch.mean by default</span></li>

<li><code class="mkapi-item-name">tbptt_reduce_fx</code>
<span class="mkapi-item-type">(callable, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">function to reduce on truncated back prop</span></li>

<li><code class="mkapi-item-name">tbptt_pad_token</code>
<span class="mkapi-item-type">(int, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">token to use for padding</span></li>

<li><code class="mkapi-item-name">enable_graph</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True, will not auto detach the graph</span></li>

<li><code class="mkapi-item-name">sync_dist</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True, reduces the metric across GPUs/TPUs</span></li>

<li><code class="mkapi-item-name">sync_dist_op</code>
<span class="mkapi-item-type">(any or str, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the op to sync across GPUs/TPUs</span></li>

<li><code class="mkapi-item-name">sync_dist_group</code>
<span class="mkapi-item-type">(any, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the ddp group</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.log_dict">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmodulelog_dict" class="mkapi-object-body method"><code class="mkapi-object-name">log_dict</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">dictionary</code>, <code class="mkapi-object-signature">prog_bar=False</code>, <code class="mkapi-object-signature">logger=True</code>, <code class="mkapi-object-signature">on_step=None</code>, <code class="mkapi-object-signature">on_epoch=None</code>, <code class="mkapi-object-signature">reduce_fx=&lt;built-in method mean of type object at 0x7f7ebfbd7860&gt;</code>, <code class="mkapi-object-signature">tbptt_reduce_fx=&lt;built-in method mean of type object at 0x7f7ebfbd7860&gt;</code>, <code class="mkapi-object-signature">tbptt_pad_token=0</code>, <code class="mkapi-object-signature">enable_graph=False</code>, <code class="mkapi-object-signature">sync_dist=False</code>, <code class="mkapi-object-signature">sync_dist_op=&#39;mean&#39;</code>, <code class="mkapi-object-signature">sync_dist_group=None</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.log_dict" title="Source for pytorch_lightning.core.lightning.LightningModule.log_dict">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Log a dictonary of values at once</p>
<p>Example::</p>
<pre><code>values = {'loss': loss, 'acc': acc, ..., 'metric_n': metric_n}
self.log_dict(values)
</code></pre></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">dictionary</code>
<span class="mkapi-item-type">(dict)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">key value pairs (str, tensors)</span></li>

<li><code class="mkapi-item-name">prog_bar</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True logs to the progress base</span></li>

<li><code class="mkapi-item-name">logger</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True logs to the logger</span></li>

<li><code class="mkapi-item-name">on_step</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True logs at this step. None auto-logs for training_step but not validation/test_step</span></li>

<li><code class="mkapi-item-name">on_epoch</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True logs epoch accumulated metrics. None auto-logs for val/test step but not training_step</span></li>

<li><code class="mkapi-item-name">reduce_fx</code>
<span class="mkapi-item-type">(callable, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">reduction function over step values for end of epoch. Torch.mean by default</span></li>

<li><code class="mkapi-item-name">tbptt_reduce_fx</code>
<span class="mkapi-item-type">(callable, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">function to reduce on truncated back prop</span></li>

<li><code class="mkapi-item-name">tbptt_pad_token</code>
<span class="mkapi-item-type">(int, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">token to use for padding</span></li>

<li><code class="mkapi-item-name">enable_graph</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True, will not auto detach the graph</span></li>

<li><code class="mkapi-item-name">sync_dist</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">if True, reduces the metric across GPUs/TPUs</span></li>

<li><code class="mkapi-item-name">sync_dist_op</code>
<span class="mkapi-item-type">(any or str, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the op to sync across GPUs/TPUs</span></li>

<li><code class="mkapi-item-name">sync_dist_group</code>
<span class="mkapi-item-type">(any, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the ddp group:</span></li>


</ul></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.all_gather">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduleall_gather" class="mkapi-object-body method"><code class="mkapi-object-name">all_gather</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">tensor</code>, <code class="mkapi-object-signature">group=None</code>, <code class="mkapi-object-signature">sync_grads=False</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.all_gather" title="Source for pytorch_lightning.core.lightning.LightningModule.all_gather">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Allows users to call <code>self.all_gather()</code> from the LightningModule, thus making
the <code>all_gather</code> operation accelerator agnostic.</p>
<p><code>all_gather</code> is a function provided by accelerators to gather a tensor from several
distributed processes</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">tensor</code>
<span class="mkapi-item-type">(Tensor)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">tensor of shape (batch, ...)</span></li>

<li><code class="mkapi-item-name">group</code>
<span class="mkapi-item-type">(any, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">the process group to gather results from. Defaults to all processes (world)</span></li>

<li><code class="mkapi-item-name">sync_grads</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">flag that allows users to synchronize gradients for all_gather op</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    A tensor of shape (world_size, batch, ...)</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.forward">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduleforward" class="mkapi-object-body method"><code class="mkapi-object-name">forward</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.forward" title="Source for pytorch_lightning.core.lightning.LightningModule.forward">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Same as :meth:<code>torch.nn.Module.forward()</code>, however in Lightning you want this to define
the operations you want to use for prediction (i.e.: on a server or as a feature extractor).</p>
<p>Normally you'd call <code>self()</code> from your :meth:<code>training_step</code> method.
This makes it easy to write a complex system for training with the outputs
you'd want in a prediction setting.</p>
<p>You may also find the :func:<code>~pytorch_lightning.core.decorators.auto_move_data</code> decorator useful
when using the module outside Lightning in a production setting.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">*args</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Whatever you decide to pass into the forward method.</span></li>

<li><code class="mkapi-item-name">**kwargs</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Keyword arguments are also possible.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    Predicted output</p></div>
    </div>
  <div class="mkapi-section examples">
      <div class="mkapi-section-name examples">
          <span class="mkapi-section-name-body examples">Examples</span> 
        </div>
      <div class="mkapi-section-body examples"><p>.. code-block:: python</p>
<pre><code># example if we were using this model as a feature extractor
def forward(self, x):
    feature_maps = self.convnet(x)
    return feature_maps

def training_step(self, batch, batch_idx):
    x, y = batch
    feature_maps = self(x)
    logits = self.classifier(feature_maps)

    # ...
    return loss

# splitting it this way allows model to be used a feature extractor
model = MyModelAbove()

inputs = server.get_request()
results = model(inputs)
server.write_results(results)

# -------------
# This is in stark contrast to torch.nn.Module where normally you would have this:
def forward(self, batch):
    x, y = batch
    feature_maps = self.convnet(x)
    logits = self.classifier(feature_maps)
    return logits
</code></pre></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.training_step">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduletraining_step" class="mkapi-object-body method"><code class="mkapi-object-name">training_step</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.training_step" title="Source for pytorch_lightning.core.lightning.LightningModule.training_step">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Here you compute and return the training loss and some additional metrics for e.g.
the progress bar or logger.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">


<li><code class="mkapi-item-name">batch (</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">class:<code>~torch.Tensor</code> | (:class:<code>~torch.Tensor</code>, ...) | [:class:<code>~torch.Tensor</code>, ...]):
The output of your :class:<code>~torch.utils.data.DataLoader</code>. A tensor, tuple or list.</span></li>

<li><code class="mkapi-item-name">batch_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Integer displaying index of this batch</span></li>

<li><code class="mkapi-item-name">optimizer_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">When using multiple optimizers, this argument will also be present.</span></li>

<li><code class="mkapi-item-name">hiddens(</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">class:<code>~torch.Tensor</code>): Passed in if
:paramref:<code>~pytorch_lightning.trainer.trainer.Trainer.truncated_bptt_steps</code> &gt; 0.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    Any of.</p>
<pre><code>- :class:`~torch.Tensor` - The loss tensor
- `dict` - A dictionary. Can include any keys, but must include the key 'loss'
- `None` - Training will skip to the next batch
</code></pre>
<p>In this step you'd normally do the forward pass and calculate the loss for a batch.
You can also do fancier things like multiple forward passes or something model specific.</p>
<p>Example::</p>
<pre><code>def training_step(self, batch, batch_idx):
    x, y, z = batch
    out = self.encoder(x)
    loss = self.loss(out, x)
    return loss
</code></pre>
<p>If you define multiple optimizers, this step will be called with an additional
<code>optimizer_idx</code> parameter.</p>
<p>.. code-block:: python</p>
<pre><code># Multiple optimizers (e.g.: GANs)
def training_step(self, batch, batch_idx, optimizer_idx):
    if optimizer_idx == 0:
        # do training_step with encoder
    if optimizer_idx == 1:
        # do training_step with decoder
</code></pre>
<p>If you add truncated back propagation through time you will also get an additional
argument with the hidden states of the previous step.</p>
<p>.. code-block:: python</p>
<pre><code># Truncated back-propagation through time
def training_step(self, batch, batch_idx, hiddens):
    # hiddens are the hidden states from the previous truncated backprop step
    ...
    out, hiddens = self.lstm(data, hiddens)
    ...
    return {'loss': loss, 'hiddens': hiddens}
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The loss value shown in the progress bar is smoothed (averaged) over the last values,
so it differs from the actual loss returned in train/validation step.</p>
</div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.training_step_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduletraining_step_end" class="mkapi-object-body method"><code class="mkapi-object-name">training_step_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.training_step_end" title="Source for pytorch_lightning.core.lightning.LightningModule.training_step_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Use this when training with dp or ddp2 because :meth:<code>training_step</code>
will operate on only part of the batch. However, this is still optional
and only needed for things like softmax or NCE loss.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you later switch to ddp or some other mode, this will still be called
so that you don't have to change your code</p>
</div></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>.. code-block:: python</p>
<pre><code># pseudocode
sub_batches = split_batches_for_dp(batch)
batch_parts_outputs = [training_step(sub_batch) for sub_batch in sub_batches]
training_step_end(batch_parts_outputs)
</code></pre></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">


<li><code class="mkapi-item-name">batch_parts_outputs</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">What you return in <code>training_step</code> for each batch part.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    Anything</p>
<p>When using dp/ddp2 distributed backends, only a portion of the batch is inside the training_step:</p>
<p>.. code-block:: python</p>
<pre><code>def training_step(self, batch, batch_idx):
    # batch is 1/num_gpus big
    x, y = batch

    out = self(x)

    # softmax uses only a portion of the batch in the denomintaor
    loss = self.softmax(out)
    loss = nce_loss(loss)
    return loss
</code></pre>
<p>If you wish to do something with all the parts of the batch, then use this method to do it:</p>
<p>.. code-block:: python</p>
<pre><code>def training_step(self, batch, batch_idx):
    # batch is 1/num_gpus big
    x, y = batch

    out = self.encoder(x)
    return {'pred': out}

def training_step_end(self, training_step_outputs):
    gpu_0_pred = training_step_outputs[0]['pred']
    gpu_1_pred = training_step_outputs[1]['pred']
    gpu_n_pred = training_step_outputs[n]['pred']

    # this softmax now uses the full batch
    loss = nce_loss([gpu_0_pred, gpu_1_pred, gpu_n_pred])
    return loss
</code></pre></div>
    </div>
  <div class="mkapi-section see-also">
      <div class="mkapi-section-name see-also">
          <span class="mkapi-section-name-body see-also">See Also</span> 
        </div>
      <div class="mkapi-section-body see-also"><p>See the :ref:<code>multi_gpu</code> guide for more details.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.training_epoch_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduletraining_epoch_end" class="mkapi-object-body method"><code class="mkapi-object-name">training_epoch_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">outputs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.training_epoch_end" title="Source for pytorch_lightning.core.lightning.LightningModule.training_epoch_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called at the end of the training epoch with the outputs of all training steps.
Use this in case you need to do something with all the outputs for every training_step.</p>
<p>.. code-block:: python</p>
<pre><code># the pseudocode for these calls
train_outs = []
for train_batch in train_data:
    out = training_step(train_batch)
    train_outs.append(out)
training_epoch_end(train_outs)
</code></pre></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">outputs</code>
<span class="mkapi-item-type">(list of any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">List of outputs you defined in :meth:<code>training_step</code>, or if there are
multiple dataloaders, a list containing a list of outputs for each dataloader.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    None</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If this method is not overridden, this won't be called.</p>
</div></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Example::</p>
<pre><code>def training_epoch_end(self, training_step_outputs):
    # do something with all training_step outputs
    return result
</code></pre>
<p>With multiple dataloaders, <code>outputs</code> will be a list of lists. The outer list contains
one entry per dataloader, while the inner list contains the individual outputs of
each training step for that dataloader.</p>
<p>.. code-block:: python</p>
<pre><code>def training_epoch_end(self, training_step_outputs):
    for out in training_step_outputs:
        # do something here
</code></pre></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.validation_step">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmodulevalidation_step" class="mkapi-object-body method"><code class="mkapi-object-name">validation_step</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.validation_step" title="Source for pytorch_lightning.core.lightning.LightningModule.validation_step">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Operates on a single batch of data from the validation set.
In this step you'd might generate examples or calculate anything of interest like accuracy.</p>
<p>.. code-block:: python</p>
<pre><code># the pseudocode for these calls
val_outs = []
for val_batch in val_data:
    out = validation_step(val_batch)
    val_outs.append(out)
    validation_epoch_end(val_outs)
</code></pre></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">


<li><code class="mkapi-item-name">batch (</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">class:<code>~torch.Tensor</code> | (:class:<code>~torch.Tensor</code>, ...) | [:class:<code>~torch.Tensor</code>, ...]):
The output of your :class:<code>~torch.utils.data.DataLoader</code>. A tensor, tuple or list.</span></li>

<li><code class="mkapi-item-name">batch_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The index of this batch</span></li>

<li><code class="mkapi-item-name">dataloader_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The index of the dataloader that produced this batch
(only if multiple val datasets used)</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
   Any of.</p>
<pre><code>- Any object or value
- `None` - Validation will skip to the next batch
</code></pre>
<p>.. code-block:: python</p>
<pre><code># pseudocode of order
out = validation_step()
if defined('validation_step_end'):
    out = validation_step_end(out)
out = validation_epoch_end(out)
</code></pre>
<p>.. code-block:: python</p>
<pre><code># if you have one val dataloader:
def validation_step(self, batch, batch_idx)

# if you have multiple val dataloaders:
def validation_step(self, batch, batch_idx, dataloader_idx)
</code></pre></div>
    </div>
  <div class="mkapi-section examples">
      <div class="mkapi-section-name examples">
          <span class="mkapi-section-name-body examples">Examples</span> 
        </div>
      <div class="mkapi-section-body examples"><p>.. code-block:: python</p>
<pre><code># CASE 1: A single validation dataset
def validation_step(self, batch, batch_idx):
    x, y = batch

    # implement your own
    out = self(x)
    loss = self.loss(out, y)

    # log 6 example images
    # or generated text... or whatever
    sample_imgs = x[:6]
    grid = torchvision.utils.make_grid(sample_imgs)
    self.logger.experiment.add_image('example_images', grid, 0)

    # calculate acc
    labels_hat = torch.argmax(out, dim=1)
    val_acc = torch.sum(y == labels_hat).item() / (len(y) * 1.0)

    # log the outputs!
    self.log_dict({'val_loss': loss, 'val_acc': val_acc})
</code></pre>
<p>If you pass in multiple val datasets, validation_step will have an additional argument.</p>
<p>.. code-block:: python</p>
<pre><code># CASE 2: multiple validation datasets
def validation_step(self, batch, batch_idx, dataloader_idx):
    # dataloader_idx tells you which dataset this is.
</code></pre></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don't need to validate you don't need to implement this method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the :meth:<code>validation_step</code> is called, the model has been put in eval mode
and PyTorch gradients have been disabled. At the end of validation,
the model goes back to training mode and gradients are enabled.</p>
</div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.validation_step_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmodulevalidation_step_end" class="mkapi-object-body method"><code class="mkapi-object-name">validation_step_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.validation_step_end" title="Source for pytorch_lightning.core.lightning.LightningModule.validation_step_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Use this when validating with dp or ddp2 because :meth:<code>validation_step</code>
will operate on only part of the batch. However, this is still optional
and only needed for things like softmax or NCE loss.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you later switch to ddp or some other mode, this will still be called
so that you don't have to change your code.</p>
</div></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>.. code-block:: python</p>
<pre><code># pseudocode
sub_batches = split_batches_for_dp(batch)
batch_parts_outputs = [validation_step(sub_batch) for sub_batch in sub_batches]
validation_step_end(batch_parts_outputs)
</code></pre></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">


<li><code class="mkapi-item-name">batch_parts_outputs</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">What you return in :meth:<code>validation_step</code>
for each batch part.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    None or anything</p>
<p>.. code-block:: python</p>
<pre><code># WITHOUT validation_step_end
# if used in DP or DDP2, this batch is 1/num_gpus large
def validation_step(self, batch, batch_idx):
    # batch is 1/num_gpus big
    x, y = batch

    out = self.encoder(x)
    loss = self.softmax(out)
    loss = nce_loss(loss)
    self.log('val_loss', loss)

# --------------
# with validation_step_end to do softmax over the full batch
def validation_step(self, batch, batch_idx):
    # batch is 1/num_gpus big
    x, y = batch

    out = self(x)
    return out

def validation_epoch_end(self, val_step_outputs):
    for out in val_step_outputs:
        # do something with these
</code></pre></div>
    </div>
  <div class="mkapi-section see-also">
      <div class="mkapi-section-name see-also">
          <span class="mkapi-section-name-body see-also">See Also</span> 
        </div>
      <div class="mkapi-section-body see-also"><p>See the :ref:<code>multi_gpu</code> guide for more details.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.validation_epoch_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmodulevalidation_epoch_end" class="mkapi-object-body method"><code class="mkapi-object-name">validation_epoch_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">outputs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.validation_epoch_end" title="Source for pytorch_lightning.core.lightning.LightningModule.validation_epoch_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called at the end of the validation epoch with the outputs of all validation steps.</p>
<p>.. code-block:: python</p>
<pre><code># the pseudocode for these calls
val_outs = []
for val_batch in val_data:
    out = validation_step(val_batch)
    val_outs.append(out)
validation_epoch_end(val_outs)
</code></pre></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">outputs</code>
<span class="mkapi-item-type">(list of any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">List of outputs you defined in :meth:<code>validation_step</code>, or if there
are multiple dataloaders, a list containing a list of outputs for each dataloader.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    None</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you didn't define a :meth:<code>validation_step</code>, this won't be called.</p>
</div></div>
    </div>
  <div class="mkapi-section examples">
      <div class="mkapi-section-name examples">
          <span class="mkapi-section-name-body examples">Examples</span> 
        </div>
      <div class="mkapi-section-body examples"><p>With a single dataloader:</p>
<p>.. code-block:: python</p>
<pre><code>def validation_epoch_end(self, val_step_outputs):
    for out in val_step_outputs:
        # do something
</code></pre>
<p>With multiple dataloaders, <code>outputs</code> will be a list of lists. The outer list contains
one entry per dataloader, while the inner list contains the individual outputs of
each validation step for that dataloader.</p>
<p>.. code-block:: python</p>
<pre><code>def validation_epoch_end(self, outputs):
    for dataloader_output_result in outputs:
        dataloader_outs = dataloader_output_result.dataloader_i_outputs

    self.log('final_metric', final_value)
</code></pre></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.test_step">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduletest_step" class="mkapi-object-body method"><code class="mkapi-object-name">test_step</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.test_step" title="Source for pytorch_lightning.core.lightning.LightningModule.test_step">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Operates on a single batch of data from the test set.
In this step you'd normally generate examples or calculate anything of interest
such as accuracy.</p>
<p>.. code-block:: python</p>
<pre><code># the pseudocode for these calls
test_outs = []
for test_batch in test_data:
    out = test_step(test_batch)
    test_outs.append(out)
test_epoch_end(test_outs)
</code></pre></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">


<li><code class="mkapi-item-name">batch (</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">class:<code>~torch.Tensor</code> | (:class:<code>~torch.Tensor</code>, ...) | [:class:<code>~torch.Tensor</code>, ...]):
The output of your :class:<code>~torch.utils.data.DataLoader</code>. A tensor, tuple or list.</span></li>

<li><code class="mkapi-item-name">batch_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The index of this batch.</span></li>

<li><code class="mkapi-item-name">dataloader_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The index of the dataloader that produced this batch
(only if multiple test datasets used).</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
   Any of.</p>
<pre><code>- Any object or value
- `None` - Testing will skip to the next batch
</code></pre>
<p>.. code-block:: python</p>
<pre><code># if you have one test dataloader:
def test_step(self, batch, batch_idx)

# if you have multiple test dataloaders:
def test_step(self, batch, batch_idx, dataloader_idx)
</code></pre></div>
    </div>
  <div class="mkapi-section examples">
      <div class="mkapi-section-name examples">
          <span class="mkapi-section-name-body examples">Examples</span> 
        </div>
      <div class="mkapi-section-body examples"><p>.. code-block:: python</p>
<pre><code># CASE 1: A single test dataset
def test_step(self, batch, batch_idx):
    x, y = batch

    # implement your own
    out = self(x)
    loss = self.loss(out, y)

    # log 6 example images
    # or generated text... or whatever
    sample_imgs = x[:6]
    grid = torchvision.utils.make_grid(sample_imgs)
    self.logger.experiment.add_image('example_images', grid, 0)

    # calculate acc
    labels_hat = torch.argmax(out, dim=1)
    test_acc = torch.sum(y == labels_hat).item() / (len(y) * 1.0)

    # log the outputs!
    self.log_dict({'test_loss': loss, 'test_acc': test_acc})
</code></pre>
<p>If you pass in multiple validation datasets, :meth:<code>test_step</code> will have an additional
argument.</p>
<p>.. code-block:: python</p>
<pre><code># CASE 2: multiple test datasets
def test_step(self, batch, batch_idx, dataloader_idx):
    # dataloader_idx tells you which dataset this is.
</code></pre></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don't need to validate you don't need to implement this method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the :meth:<code>test_step</code> is called, the model has been put in eval mode and
PyTorch gradients have been disabled. At the end of the test epoch, the model goes back
to training mode and gradients are enabled.</p>
</div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.test_step_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduletest_step_end" class="mkapi-object-body method"><code class="mkapi-object-name">test_step_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.test_step_end" title="Source for pytorch_lightning.core.lightning.LightningModule.test_step_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Use this when testing with dp or ddp2 because :meth:<code>test_step</code> will operate
on only part of the batch. However, this is still optional
and only needed for things like softmax or NCE loss.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you later switch to ddp or some other mode, this will still be called
so that you don't have to change your code.</p>
</div></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>.. code-block:: python</p>
<pre><code># pseudocode
sub_batches = split_batches_for_dp(batch)
batch_parts_outputs = [test_step(sub_batch) for sub_batch in sub_batches]
test_step_end(batch_parts_outputs)
</code></pre></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">


<li><code class="mkapi-item-name">batch_parts_outputs</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">What you return in :meth:<code>test_step</code> for each batch part.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    None or anything</p>
<p>.. code-block:: python</p>
<pre><code># WITHOUT test_step_end
# if used in DP or DDP2, this batch is 1/num_gpus large
def test_step(self, batch, batch_idx):
    # batch is 1/num_gpus big
    x, y = batch

    out = self(x)
    loss = self.softmax(out)
    self.log('test_loss', loss)

# --------------
# with test_step_end to do softmax over the full batch
def test_step(self, batch, batch_idx):
    # batch is 1/num_gpus big
    x, y = batch

    out = self.encoder(x)
    return out

def test_epoch_end(self, output_results):
    # this out is now the full size of the batch
    all_test_step_outs = output_results.out
    loss = nce_loss(all_test_step_outs)
    self.log('test_loss', loss)
</code></pre></div>
    </div>
  <div class="mkapi-section see-also">
      <div class="mkapi-section-name see-also">
          <span class="mkapi-section-name-body see-also">See Also</span> 
        </div>
      <div class="mkapi-section-body see-also"><p>See the :ref:<code>multi_gpu</code> guide for more details.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.test_epoch_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduletest_epoch_end" class="mkapi-object-body method"><code class="mkapi-object-name">test_epoch_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">outputs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.test_epoch_end" title="Source for pytorch_lightning.core.lightning.LightningModule.test_epoch_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called at the end of a test epoch with the output of all test steps.</p>
<p>.. code-block:: python</p>
<pre><code># the pseudocode for these calls
test_outs = []
for test_batch in test_data:
    out = test_step(test_batch)
    test_outs.append(out)
test_epoch_end(test_outs)
</code></pre></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">outputs</code>
<span class="mkapi-item-type">(list of any)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">List of outputs you defined in :meth:<code>test_step_end</code>, or if there
are multiple dataloaders, a list containing a list of outputs for each dataloader</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    None</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you didn't define a :meth:<code>test_step</code>, this won't be called.</p>
</div></div>
    </div>
  <div class="mkapi-section examples">
      <div class="mkapi-section-name examples">
          <span class="mkapi-section-name-body examples">Examples</span> 
        </div>
      <div class="mkapi-section-body examples"><p>With a single dataloader:</p>
<p>.. code-block:: python</p>
<pre><code>def test_epoch_end(self, outputs):
    # do something with the outputs of all test batches
    all_test_preds = test_step_outputs.predictions

    some_result = calc_all_results(all_test_preds)
    self.log(some_result)
</code></pre>
<p>With multiple dataloaders, <code>outputs</code> will be a list of lists. The outer list contains
one entry per dataloader, while the inner list contains the individual outputs of
each test step for that dataloader.</p>
<p>.. code-block:: python</p>
<pre><code>def test_epoch_end(self, outputs):
    final_value = 0
    for dataloader_outputs in outputs:
        for test_step_out in dataloader_outputs:
            # do something
            final_value += test_step_out

    self.log('final_metric', final_value)
</code></pre></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.manual_backward">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmodulemanual_backward" class="mkapi-object-body method"><code class="mkapi-object-name">manual_backward</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">loss</code>, <code class="mkapi-object-signature">optimizer</code>, <code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.manual_backward" title="Source for pytorch_lightning.core.lightning.LightningModule.manual_backward">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Call this directly from your training_step when doing optimizations manually.
By using this we can ensure that all the proper scaling when using 16-bit etc has been done for you</p>
<p>This function forwards all args to the .backward() call as well.</p>
<p>.. tip:: In manual mode we still automatically clip grads if Trainer(gradient_clip_val=x) is set</p>
<p>.. tip:: In manual mode we still automatically accumulate grad over batches if
   Trainer(accumulate_grad_batches=x) is set and you use <code>optimizer.step()</code></p>
<p>Example::</p>
<pre><code>def training_step(...):
    (opt_a, opt_b) = self.optimizers()
    loss = ...
    # automatically applies scaling, etc...
    self.manual_backward(loss, opt_a)
    opt_a.step()
</code></pre></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.backward">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmodulebackward" class="mkapi-object-body method"><code class="mkapi-object-name">backward</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">loss</code>, <code class="mkapi-object-signature">optimizer</code>, <code class="mkapi-object-signature">optimizer_idx</code>, <code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.backward" title="Source for pytorch_lightning.core.lightning.LightningModule.backward">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Override backward with your own implementation if you need to.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">loss</code>
<span class="mkapi-item-type">(Tensor)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Loss is already scaled by accumulated grads</span></li>

<li><code class="mkapi-item-name">optimizer</code>
<span class="mkapi-item-type">(Optimizer)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Current optimizer being used</span></li>

<li><code class="mkapi-item-name">optimizer_idx</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Index of the current optimizer being used</span></li>




</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Called to perform backward step.
Feel free to override as needed.
The loss passed in has already been scaled for accumulated gradients if requested.</p>
<p>Example::</p>
<pre><code>def backward(self, loss, optimizer, optimizer_idx):
    loss.backward()
</code></pre></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.toggle_optimizer">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduletoggle_optimizer" class="mkapi-object-body method"><code class="mkapi-object-name">toggle_optimizer</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">optimizer</code>, <code class="mkapi-object-signature">optimizer_idx</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.toggle_optimizer" title="Source for pytorch_lightning.core.lightning.LightningModule.toggle_optimizer">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Makes sure only the gradients of the current optimizer's parameters are calculated
in the training step to prevent dangling gradients in multiple-optimizer setup.</p>
<p>.. note:: Only called when using multiple optimizers</p>
<p>Override for your own behavior</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.optimizer_step">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduleoptimizer_step" class="mkapi-object-body method"><code class="mkapi-object-name">optimizer_step</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">epoch=None</code>, <code class="mkapi-object-signature">batch_idx=None</code>, <code class="mkapi-object-signature">optimizer=None</code>, <code class="mkapi-object-signature">optimizer_idx=None</code>, <code class="mkapi-object-signature">optimizer_closure=None</code>, <code class="mkapi-object-signature">on_tpu=None</code>, <code class="mkapi-object-signature">using_native_amp=None</code>, <code class="mkapi-object-signature">using_lbfgs=None</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.optimizer_step" title="Source for pytorch_lightning.core.lightning.LightningModule.optimizer_step">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Override this method to adjust the default way the
:class:<code>~pytorch_lightning.trainer.trainer.Trainer</code> calls each optimizer.
By default, Lightning calls <code>step()</code> and <code>zero_grad()</code> as shown in the example
once per optimizer.</p>
<p>.. tip:: With <code>Trainer(enable_pl_optimizer=True)</code>, you can user <code>optimizer.step()</code> directly and it will handle zero_grad, accumulated gradients, AMP, TPU and more automatically for you.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you are overriding this method, make sure that you pass the <code>optimizer_closure</code> parameter
to <code>optimizer.step()</code> function as shown in the examples. This ensures that
<code>train_step_and_backward_closure</code> is called within
:meth:<code>~pytorch_lightning.trainer.training_loop.TrainLoop.run_training_batch</code>.</p>
</div></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">epoch</code>
<span class="mkapi-item-type">(int, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Current epoch</span></li>

<li><code class="mkapi-item-name">batch_idx</code>
<span class="mkapi-item-type">(int, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Index of current batch</span></li>

<li><code class="mkapi-item-name">optimizer</code>
<span class="mkapi-item-type">(Optimizer, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">A PyTorch optimizer</span></li>

<li><code class="mkapi-item-name">optimizer_idx</code>
<span class="mkapi-item-type">(int, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">If you used multiple optimizers this indexes into that list.</span></li>

<li><code class="mkapi-item-name">optimizer_closure</code>
<span class="mkapi-item-type">(callable, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">closure for all optimizers</span></li>

<li><code class="mkapi-item-name">on_tpu</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">true if TPU backward is required</span></li>

<li><code class="mkapi-item-name">using_native_amp</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">True if using native amp</span></li>

<li><code class="mkapi-item-name">using_lbfgs</code>
<span class="mkapi-item-type">(bool, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">True if the matching optimizer is lbfgs</span></li>


</ul></div>
    </div>
  <div class="mkapi-section examples">
      <div class="mkapi-section-name examples">
          <span class="mkapi-section-name-body examples">Examples</span> 
        </div>
      <div class="mkapi-section-body examples"><p>.. code-block:: python</p>
<pre><code># DEFAULT
def optimizer_step(self, epoch, batch_idx, optimizer, optimizer_idx,
                   optimizer_closure, on_tpu, using_native_amp, using_lbfgs):
    optimizer.step(closure=optimizer_closure)

# Alternating schedule for optimizer steps (i.e.: GANs)
def optimizer_step(self, epoch, batch_idx, optimizer, optimizer_idx,
                   optimizer_closure, on_tpu, using_native_amp, using_lbfgs):
    # update generator opt every 2 steps
    if optimizer_idx == 0:
        if batch_idx % 2 == 0 :
            optimizer.step(closure=optimizer_closure)
            optimizer.zero_grad()

    # update discriminator opt every 4 steps
    if optimizer_idx == 1:
        if batch_idx % 4 == 0 :
            optimizer.step(closure=optimizer_closure)
            optimizer.zero_grad()

    # ...
    # add as many optimizers as you want
</code></pre></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>s
:</p>
<p>n</p>
<p>p
,
:
r
:
)
:
e</p>
<p>s
)
)</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.tbptt_split_batch">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduletbptt_split_batch" class="mkapi-object-body method"><code class="mkapi-object-name">tbptt_split_batch</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">batch</code>, <code class="mkapi-object-signature">split_size</code><code class="mkapi-object-parenthesis">)</code><span class="mkapi-item-type"> &#x2192; list</span></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.tbptt_split_batch" title="Source for pytorch_lightning.core.lightning.LightningModule.tbptt_split_batch">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>When using truncated backpropagation through time, each batch must be split along the
time dimension. Lightning handles this by default, but for custom behavior override
this function.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">batch</code>
<span class="mkapi-item-type">(Tensor)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Current batch</span></li>

<li><code class="mkapi-item-name">split_size</code>
<span class="mkapi-item-type">(int)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The size of the split</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    List of batch splits. Each split will be passed to :meth:<code>training_step</code> to enable truncated
    back propagation through time. The default implementation splits root level Tensors and
    Sequences at dim=1 (i.e. time dim). It assumes that each time dim is the same length.</p></div>
    </div>
  <div class="mkapi-section examples">
      <div class="mkapi-section-name examples">
          <span class="mkapi-section-name-body examples">Examples</span> 
        </div>
      <div class="mkapi-section-body examples"><p>.. code-block:: python</p>
<pre><code>def tbptt_split_batch(self, batch, split_size):
  splits = []
  for t in range(0, time_dims[0], split_size):
      batch_split = []
      for i, x in enumerate(batch):
          if isinstance(x, torch.Tensor):
              split_x = x[:, t:t + split_size]
          elif isinstance(x, collections.Sequence):
              split_x = [None] * len(x)
              for batch_idx in range(len(x)):
                  split_x[batch_idx] = x[batch_idx][t:t + split_size]

          batch_split.append(split_x)

      splits.append(batch_split)

  return splits
</code></pre></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Called in the training loop after
:meth:<code>~pytorch_lightning.callbacks.base.Callback.on_batch_start</code>
if :paramref:<code>~pytorch_lightning.trainer.Trainer.truncated_bptt_steps</code> &gt; 0.
Each returned batch split is passed separately to :meth:<code>training_step</code>.</p>
</div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.freeze">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmodulefreeze" class="mkapi-object-body method"><code class="mkapi-object-name">freeze</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.freeze" title="Source for pytorch_lightning.core.lightning.LightningModule.freeze">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Freeze all params for inference.</p></div>
    </div>
  <div class="mkapi-section example">
      <div class="mkapi-section-name example">
          <span class="mkapi-section-name-body example">Example</span> 
        </div>
      <div class="mkapi-section-body example"><p>.. code-block:: python</p>
<pre><code>model = MyLightningModule(...)
model.freeze()
</code></pre></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.unfreeze">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduleunfreeze" class="mkapi-object-body method"><code class="mkapi-object-name">unfreeze</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.unfreeze" title="Source for pytorch_lightning.core.lightning.LightningModule.unfreeze">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Unfreeze all parameters for training.</p>
<p>.. code-block:: python</p>
<pre><code>model = MyLightningModule(...)
model.unfreeze()
</code></pre></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.get_progress_bar_dict">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduleget_progress_bar_dict" class="mkapi-object-body method"><code class="mkapi-object-name">get_progress_bar_dict</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code><span class="mkapi-item-type"> &#x2192; dict(str: int or str)</span></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.get_progress_bar_dict" title="Source for pytorch_lightning.core.lightning.LightningModule.get_progress_bar_dict">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Implement this to override the default items displayed in the progress bar.
By default it includes the average loss value, split index of BPTT (if used)
and the version of the experiment when using a logger.</p>
<p>.. code-block::</p>
<pre><code>Epoch 1:   4%|         | 40/1095 [00:03&lt;01:37, 10.84it/s, loss=4.501, v_num=10]
</code></pre>
<p>Here is an example how to override the defaults:</p>
<p>.. code-block:: python</p>
<pre><code>def get_progress_bar_dict(self):
    # don't show the version number
    items = super().get_progress_bar_dict()
    items.pop("v_num", None)
    return items
</code></pre>
<p>Return:
    Dictionary with the items to be displayed in the progress bar.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.save_hyperparameters">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmodulesave_hyperparameters" class="mkapi-object-body method"><code class="mkapi-object-name">save_hyperparameters</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">*args</code>, <code class="mkapi-object-signature">frame=None</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.save_hyperparameters" title="Source for pytorch_lightning.core.lightning.LightningModule.save_hyperparameters">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Save all model arguments.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">


<li><code class="mkapi-item-name">args</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">single object of <code>dict</code>, <code>NameSpace</code> or <code>OmegaConf</code>
or string names or argumenst from class <code>__init__</code></span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">ManuallyArgsModel</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">):</span>
<span class="o">...</span>         <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="o">...</span>         <span class="c1"># manually assign arguments</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">save_hyperparameters</span><span class="p">(</span><span class="s1">&#39;arg1&#39;</span><span class="p">,</span> <span class="s1">&#39;arg3&#39;</span><span class="p">)</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="o">...</span>         <span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">ManuallyArgsModel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">hparams</span>
<span class="s2">&quot;arg1&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="s2">&quot;arg3&quot;</span><span class="p">:</span> <span class="mf">3.14</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">AutomaticArgsModel</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">):</span>
<span class="o">...</span>         <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="o">...</span>         <span class="c1"># equivalent automatic</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">save_hyperparameters</span><span class="p">()</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="o">...</span>         <span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">AutomaticArgsModel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">hparams</span>
<span class="s2">&quot;arg1&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="s2">&quot;arg2&quot;</span><span class="p">:</span> <span class="n">abc</span>
<span class="s2">&quot;arg3&quot;</span><span class="p">:</span> <span class="mf">3.14</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">SingleArgModel</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="o">...</span>         <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="o">...</span>         <span class="c1"># manually assign single argument</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">save_hyperparameters</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="o">...</span>         <span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">SingleArgModel</span><span class="p">(</span><span class="n">Namespace</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="n">p3</span><span class="o">=</span><span class="mf">3.14</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">hparams</span>
<span class="s2">&quot;p1&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="s2">&quot;p2&quot;</span><span class="p">:</span> <span class="n">abc</span>
<span class="s2">&quot;p3&quot;</span><span class="p">:</span> <span class="mf">3.14</span>
</code></pre></div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.to_onnx">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduleto_onnx" class="mkapi-object-body method"><code class="mkapi-object-name">to_onnx</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">file_path</code>, <code class="mkapi-object-signature">input_sample=None</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.to_onnx" title="Source for pytorch_lightning.core.lightning.LightningModule.to_onnx">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Saves the model in ONNX format</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">file_path</code>
<span class="mkapi-item-type">(str or Path)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">The path of the file the onnx model should be saved to.</span></li>

<li><code class="mkapi-item-name">input_sample</code>
<span class="mkapi-item-type">(any, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">An input for tracing. Default: None (Use self.example_input_array)</span></li>

<li><code class="mkapi-item-name">**kwargs</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Will be passed to torch.onnx.export function.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section example">
      <div class="mkapi-section-name example">
          <span class="mkapi-section-name-body example">Example</span> 
        </div>
      <div class="mkapi-section-body example"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">SimpleModel</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">...</span>         <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="o">...</span>         <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l1</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.onnx&#39;</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmpfile</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">()</span>
<span class="o">...</span>     <span class="n">input_sample</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span>
<span class="o">...</span>     <span class="n">model</span><span class="o">.</span><span class="n">to_onnx</span><span class="p">(</span><span class="n">tmpfile</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">input_sample</span><span class="p">,</span> <span class="n">export_params</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">tmpfile</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="pytorch_lightning.core.lightning.LightningModule.to_torchscript">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="pytorch_lightningcorelightninglightningmoduleto_torchscript" class="mkapi-object-body method"><code class="mkapi-object-name">to_torchscript</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">file_path=None</code>, <code class="mkapi-object-signature">method=&#39;script&#39;</code>, <code class="mkapi-object-signature">example_inputs=None</code>, <code class="mkapi-object-signature">**kwargs</code><code class="mkapi-object-parenthesis">)</code><span class="mkapi-item-type"> &#x2192; Union(scriptmodule, dict(str: scriptmodule))</span></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/pytorch_lightning.core.lightning/#pytorch_lightning.core.lightning.LightningModule.to_torchscript" title="Source for pytorch_lightning.core.lightning.LightningModule.to_torchscript">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>By default compiles the whole model to a :class:<code>~torch.jit.ScriptModule</code>.
If you want to use tracing, please provided the argument <code>method='trace'</code> and make sure that either the
example_inputs argument is provided, or the model has self.example_input_array set.
If you would like to customize the modules that are scripted you should override this method.
In case you want to return multiple modules, we recommend using a dictionary.</p></div>
    </div>
  <div class="mkapi-section parameters">
      <div class="mkapi-section-name parameters">
          <span class="mkapi-section-name-body parameters">Parameters</span> 
        </div>
      <div class="mkapi-section-body parameters"><ul class="mkapi-items">
<li><code class="mkapi-item-name">file_path</code>
<span class="mkapi-item-type">(str, Path, or NoneType, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Path where to save the torchscript. Default: None (no file saved).</span></li>

<li><code class="mkapi-item-name">method</code>
<span class="mkapi-item-type">(str, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Whether to use TorchScript's script or trace method. Default: 'script'</span></li>

<li><code class="mkapi-item-name">example_inputs</code>
<span class="mkapi-item-type">(any, optional)</span>
<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">An input to be used to do tracing when method is set to 'trace'.
Default: None (Use self.example_input_array)</span></li>

<li><code class="mkapi-item-name">**kwargs</code>

<span class="mkapi-item-dash">&mdash;</span> <span class="mkapi-item-description">Additional arguments that will be passed to the :func:<code>torch.jit.script</code> or
:func:<code>torch.jit.trace</code> function.</span></li>


</ul></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>Requires the implementation of the
  :meth:<code>~pytorch_lightning.core.lightning.LightningModule.forward</code> method.</li>
<li>The exported script will be set to evaluation mode.</li>
<li>It is recommended that you install the latest supported version of PyTorch
  to use this feature without limitations. See also the :mod:<code>torch.jit</code>
  documentation for supported features.</li>
</ul>
</div></div>
    </div>
  <div class="mkapi-section example">
      <div class="mkapi-section-name example">
          <span class="mkapi-section-name-body example">Example</span> 
        </div>
      <div class="mkapi-section-body example"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">SimpleModel</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">...</span>         <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="o">...</span>         <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l1</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">to_torchscript</span><span class="p">(),</span> <span class="s2">&quot;model.pt&quot;</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s2">&quot;model.pt&quot;</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">to_torchscript</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;model_trace.pt&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;trace&#39;</span><span class="p">,</span> <span class="c1"># doctest: +SKIP</span>
<span class="o">...</span>                                     <span class="n">example_inputs</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">)))</span>  <span class="c1"># doctest: +SKIP</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s2">&quot;model_trace.pt&quot;</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="kc">True</span>
</code></pre></div></div>
    </div>
  <div class="mkapi-section">
      <div class="mkapi-section-body"><p>Return:
    This LightningModule as a torchscript, regardless of whether file_path is
    defined or not.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="plkit.module.Module.on_epoch_end">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="plkitmodulemoduleon_epoch_end" class="mkapi-object-body method"><code class="mkapi-object-name">on_epoch_end</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/plkit.module/#plkit.module.Module.on_epoch_end" title="Source for plkit.module.Module.on_epoch_end">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Keep the epoch progress bar
This is not documented but working.</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="plkit.module.Module.loss_function">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="plkitmodulemoduleloss_function" class="mkapi-object-body method"><code class="mkapi-object-name">loss_function</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-signature">logits</code>, <code class="mkapi-object-signature">labels</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/plkit.module/#plkit.module.Module.loss_function" title="Source for plkit.module.Module.loss_function">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Calculate the loss</p></div>
    </div>
  </div>

</div>
    </div>
  
    <div class="mkapi-member">
      <div class="mkapi-node" id="plkit.module.Module.configure_optimizers">
<div class='mkapi-object-container'>
  <div class="mkapi-object method code">
    <div class="mkapi-object-kind method">method</div>
    <h4 id="plkitmodulemoduleconfigure_optimizers" class="mkapi-object-body method"><code class="mkapi-object-name">configure_optimizers</code><code class="mkapi-object-parenthesis">(</code><code class="mkapi-object-parenthesis">)</code></h4>
  </div>
  <div class="mkapi-src-link">
    <a class="mkapi-src-link" href="../source/plkit.module/#plkit.module.Module.configure_optimizers" title="Source for plkit.module.Module.configure_optimizers">&lt;/&gt;</a>
  </div>
</div>
<div class="mkapi-docstring">
<div class="mkapi-section">
      <div class="mkapi-section-body"><p>Configure the optimizers</p></div>
    </div>
  </div>

</div>
    </div>
  
  </div>

</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../plkit.exceptions/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                plkit.exceptions
              </div>
            </div>
          </a>
        
        
          <a href="../plkit.data/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                plkit.data
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.08c56446.min.js"></script>
      <script src="../../assets/javascripts/bundle.6ced434e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../js/mkapi.js"></script>
      
    
  </body>
</html>